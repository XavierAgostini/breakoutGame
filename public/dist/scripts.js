"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,s){for(var i=0;i<s.length;i++){var e=s[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(s,i,e){return i&&t(s.prototype,i),e&&t(s,e),s}}();console.log("working");var Game=function(){function t(){_classCallCheck(this,t),this.canvas=document.getElementById("myCanvas"),this.ctx=canvas.getContext("2d"),this.canvasOffset=canvas.getBoundingClientRect().left,this.canvasWidth=500,this.canvasHeight=800,this.interval=10,this.score=new Score,this.highScore=0,this.numLives=3,this.blockWidth=43,this.blockHeight=25,this.blocks=new Blocks(this.score),this.paddle=new Paddle((this.canvasWidth-100)/2,this.canvasHeight-40,this.canvas),this.ball=new Ball(this.canvasWidth/2,400)}return _createClass(t,[{key:"drawBlocks",value:function(){for(var t=0;t<this.blocks.blockArr.length;t++){var s=this.blocks.blockArr[t];s.active&&(this.ctx.fillStyle=s.colour,this.ctx.fillRect(s.posX,s.posY,s.width,s.height))}}},{key:"drawPaddle",value:function(){this.ctx.fillStyle=this.paddle.colour,this.ctx.fillRect(this.paddle.posX,this.paddle.posY,this.paddle.width,this.paddle.height)}},{key:"drawBall",value:function(){ctx.beginPath(),ctx.arc(this.ball.posX,this.ball.posY,this.ball.radius,0,2*Math.PI,!1),ctx.fillStyle=this.ball.colour,ctx.fill(),ctx.stroke()}},{key:"drawScreen",value:function(){ctx.clearRect(0,0,canvasWidth,canvasHeight),this.paddle.updatePosition(),this.ball.ballPhysics(this.interval,this.canvasWidth,this.canvasHeight,this.paddle,this.blocks),this.blocks.updateBlocks(this.ball),this.score.writeScore(),this.drawBlocks(),this.drawPaddle(),this.drawBall()}},{key:"startGame",value:function(){var t=this;setInterval(function(){t.drawScreen()},t.interval)}}]),t}(),Score=function(){function t(){_classCallCheck(this,t),this.score=0,this.numLives=3,this.highScore=0}return _createClass(t,[{key:"updateScore",value:function(t){this.score+=t}},{key:"writeScore",value:function(){var t="Score: "+this.score,s="Lives: "+this.numLives;ctx.font="30px sans-serif",ctx.fillText(t,10,25),ctx.fillText(s,350,25)}},{key:"resetScore",value:function(){this.score=0}}]),t}(),Ball=function(){function t(s,i){_classCallCheck(this,t),this.colour="white",this.radius=10,this.posX=s,this.posY=i,this.velX=0,this.velY=.2}return _createClass(t,[{key:"ballPhysics",value:function(t,s,i,e,h){if(this.posY+=this.velY*t,this.posX+=this.velX*t,this.posY+this.radius>=i&&(console.log("bottom wall hit"),lifeLost(),this.velY*=-1),this.posY-this.radius<=0&&(console.log("top wall hit -a"),this.velY*=-1),this.posX+this.radius>=s&&(console.log("right wall hit -a"),this.velX*=-1),this.posX-this.radius<=0&&(console.log("left wall hit -a"),this.velX*=-1),this.posY>=i-e.height-e.heightOffset&&this.posX-this.radius<=e.posX+e.width&&this.posX+this.radius>=e.posX){console.log("paddle hit -a"),this.velY*=-1;var a=this.posX/(e.posX+.5*e.width)-1;this.velX=a>.5?.5:a}}},{key:"get",value:function(t){return this[t]}}]),t}(),Paddle=function(){function t(s,i,e){_classCallCheck(this,t),this.colour="black",this.width=100,this.height=15,this.heightOffset=40,this.posX=s,this.posY=i,this.velX=0,this.speed=.5,this.canvas=e,this.canvasOffset=e.getBoundingClientRect().left;var h=this;document.addEventListener("keydown",function(t){37==t.keyCode?h.velX=-h.speed:39==t.keyCode&&(h.velX=h.speed)}),document.addEventListener("keyup",function(t){37!=t.keyCode&&39!=t.keyCode||(h.velX=0)}),this.canvas.addEventListener("mousemove",function(t){var s=t.clientX-h.canvasOffset;h.posX=s})}return _createClass(t,[{key:"updatePosition",value:function(){this.posX+=this.velX*interval,this.posX=this.posX>=canvasWidth-this.width?canvasWidth-this.width:this.posX,this.posX=this.posX<=0?0:this.posX}},{key:"get",value:function(t){return this[t]}}]),t}(),Block=function(){function t(s,i,e,h,a,l,o,c){_classCallCheck(this,t),this.id=s,this.level=i,this.active=e,this.colour=h,this.posX=a,this.posY=l,this.width=o,this.height=c}return _createClass(t,[{key:"get",value:function(t){return this[t]}},{key:"blockHit",value:function(t){var s=!1,i=this.posY+this.height;if(t.posY-t.radius<=i&&this.active)for(var e=0;e<360;e++){var h=t.posX+t.radius*Math.cos(e*Math.PI/180),a=t.posY-t.radius*Math.sin(e*Math.PI/180);if(h>=this.posX&&h<=this.posX+this.width&&a<=this.posY+this.height&&a>=this.posY){s=!0,t.velY*=-1;break}}return!!s&&(this.active=!1,!0)}}]),t}(),Blocks=function(){function t(s){_classCallCheck(this,t),this.blockArr=this.generateBlocks(),this.score=s}return _createClass(t,[{key:"generateBlocks",value:function(){for(var t=43,s=25,i=0,e=0,h=["red","#064df1","#33f106","#8037dd","yellow"],a=0,l=[],o=0;o<5;o++){i=12,e+=s+5;for(var c=0;c<10;c++){var n=new Block(a,o,(!0),h[o],i,e,t,s);l.push(n),i+=t+5,a++}}return l}},{key:"updateBlocks",value:function(t){for(var s=0,i=0;i<this.blockArr.length;i++)this.blockArr[i].active&&this.blockArr[i].blockHit(t)&&(s++,s>1&&(t.velY*=-1),this.score.updateScore(40-10*this.blockArr[i].level+1))}},{key:"get",value:function(t){return console.log(t),this[t]}}]),t}(),game=new Game;game.startGame();
"use strict";function draw(){ctx.clearRect(0,0,canvasWidth,canvasHeight),ctx.fillStyle="black",paddlePosition(),ctx.fillRect(paddle.posX,paddle.posY,paddle.width,paddle.height),ballPhysics(),refreshBlocks(blocks),ctx.beginPath(),ctx.arc(ball.posX,ball.posY,ball.radius,0,2*Math.PI,!1),ctx.fillStyle="white",ctx.fill(),ctx.stroke(),updateScore()}function generateInitialBlocks(){for(var l=blockWidth,e=blockHeight,a=0,t=0,o=0,s=[],i=0;i<5;i++){a=12,t+=e+5;for(var c=0;c<10;c++)ctx.fillStyle=blockColors[i],ctx.fillRect(a,t,l,e),s.push({id:o,posX:a,posY:t,color:blockColors[i],level:i,active:!0}),a+=l+5,o++}return s}function refreshBlocks(l){for(var e=0,a=0;a<l.length;a++)blockHit(l[a])&&(gameComplete()&&gameOver(),e++,e>1&&(ball.velY*=-1)),l[a].active&&(ctx.fillStyle=l[a].color,ctx.fillRect(l[a].posX,l[a].posY,blockWidth,blockHeight))}function blockHit(l){var e=!1,a=blocks[blocks.length-1].posY+blockHeight;if(ball.posY-ball.radius<=a&&l.active)for(var t=({x:ball.posX,y:ball.posY-ball.radius},{x:ball.posX+ball.radius,y:ball.posY},{x:ball.posX,y:ball.posY+ball.radius},{x:ball.posX-ball.radius,y:ball.posY},0);t<360;t++){var o=ball.posX+ball.radius*Math.cos(t*Math.PI/180),s=ball.posY-ball.radius*Math.sin(t*Math.PI/180);if(o>=l.posX&&o<=l.posX+blockWidth&&s<=l.posY+blockHeight&&s>=l.posY){e=!0,ball.velY*=-1,score+=40-10*l.level+1;break}}return!!e&&(blocks[l.id].active=!1,!0)}function paddlePosition(){paddle.posX+=paddle.velX*interval,paddle.posX=paddle.posX>=canvasWidth-paddle.width?canvasWidth-paddle.width:paddle.posX,paddle.posX=paddle.posX<=0?0:paddle.posX}function ballPhysics(){if(ball.posY+=ball.velY*interval,ball.posX+=ball.velX*interval,ball.posY+ball.radius>=canvasHeight&&(console.log("bottom wall hit"),lifeLost()),ball.posY-ball.radius<=0&&(console.log("top wall hit"),ball.velY*=-1),ball.posX+ball.radius>=canvasWidth&&(console.log("right wall hit"),ball.velX*=-1),ball.posX-ball.radius<=0&&(console.log("left wall hit"),ball.velX*=-1),ball.posY>=canvasHeight-paddleHeight-paddleHeightOffset&&ball.posX-ball.radius<=paddle.posX+paddle.width&&ball.posX+ball.radius>=paddle.posX){console.log("paddle hit"),ball.velY*=-1;var l=ball.posX/(paddle.posX+.5*paddle.width)-1;ball.velX=l>.5?.5:l}}function updateScore(){var l="Score: "+score,e="Lives: "+numLives;ctx.font="30px sans-serif",ctx.fillText(l,10,50),ctx.fillText(e,350,50)}function lifeLost(){numLives--,0==numLives&&gameOver(),ball.posY=ballStart}function gameComplete(){for(var l=0;l<blocks.length;l++)if(blocks[l].active)return!1;return!0}function gameOver(){console.log("Game Over"),clearInterval(game),setTimeout(function(){ctx.clearRect(0,0,canvasWidth,canvasHeight);var l=localStorage.getItem("highScore");score>l?highScore=score:highScore,localStorage.setItem("highScore",highScore),newGameBtn.style.display="inline";var e="GAME OVER",a="Your Score: "+score,t="Your High score: "+highScore;ctx.font="30px sans-serif",ctx.fillText(e,150,50),ctx.fillText(a,150,150),ctx.fillText(t,150,200)},interval)}var canvas=document.getElementById("myCanvas"),canvasOffset=canvas.getBoundingClientRect().left;console.log("offset-left: ",canvasOffset);var canvasHeight=800,canvasWidth=500,ctx=canvas.getContext("2d"),interval=10,blockColors=["red","#064df1","#33f106","#8037dd","yellow"],blockWidth=43,blockHeight=25,paddleHeight=15,paddleHeightOffset=40,paddleSpeed=.5,paddle={posX:(canvasWidth-50)/2,posY:canvasHeight-paddleHeightOffset,velX:0,velY:0,width:100,height:15},ballStart=200,ball={radius:10,posX:400,posY:ballStart,accelX:0,accelY:0,velX:0,velY:.2},score=0,numLives=1,highScore=localStorage.getItem("highScore")||0,newGameBtn=document.getElementById("newGameBtn");canvas.addEventListener("mousemove",function(l){var e=l.clientX-canvasOffset;l.clientY;paddle.posX=e}),document.addEventListener("keydown",function(l){37==l.keyCode?paddle.velX=-paddleSpeed:39==l.keyCode&&(paddle.velX=paddleSpeed)}),document.addEventListener("keyup",function(l){37!=l.keyCode&&39!=l.keyCode||(paddle.velX=0)}),newGameBtn.addEventListener("click",function(l){newGameBtn.style.display="none",blocks=generateInitialBlocks(),numLives=1,score=0,game=setInterval(draw,interval)});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJyZWFrb3V0LmpzIiwib2xkLWJyZWFrb3V0LmpzIl0sIm5hbWVzIjpbImNvbnNvbGUiLCJsb2ciLCJHYW1lIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjdHgiLCJjYW52YXMiLCJnZXRDb250ZXh0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwibGVmdCIsImNhbnZhc1dpZHRoIiwiY2FudmFzSGVpZ2h0IiwiY2FudmFzT2Zmc2V0IiwiYmxvY2tXaWR0aCIsImludGVydmFsIiwic2NvcmUiLCJTY29yZSIsInBhZGRsZSIsIlBhZGRsZSIsImJsb2NrSGVpZ2h0IiwiQmFsbCIsImkiLCJibG9ja3MiLCJibG9ja0FyciIsImxlbmd0aCIsImJsb2NrIiwiYWN0aXZlIiwiZmlsbFN0eWxlIiwiY29sb3VyIiwiZmlsbFJlY3QiLCJwb3NYIiwicG9zWSIsIndpZHRoIiwiaGVpZ2h0IiwiYmVnaW5QYXRoIiwiYXJjIiwiYmFsbCIsInJhZGl1cyIsIk1hdGgiLCJQSSIsImZpbGwiLCJzdHJva2UiLCJjbGVhclJlY3QiLCJiYWxsUGh5c2ljcyIsInVwZGF0ZUJsb2NrcyIsIndyaXRlU2NvcmUiLCJkcmF3QmxvY2tzIiwiZHJhd1BhZGRsZSIsImRyYXdCYWxsIiwidCIsInNldEludGVydmFsIiwiZHJhd1NjcmVlbiIsIm51bUxpdmVzIiwiaGlnaFNjb3JlIiwic2NvcmVNZXNzYWdlIiwibGl2ZU1lc3NhZ2UiLCJmb250IiwiZmlsbFRleHQiLCJ2ZWxYIiwidmVsWSIsImxpZmVMb3N0IiwiaGVpZ2h0T2Zmc2V0Iiwic3BlZWQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXlDb2RlIiwicHJvcGVydHkiLCJ4IiwiY2xpZW50WCIsIkJsb2NrIiwiaWQiLCJsZXZlbCIsImhpdCIsImJsb2NrU2VjdGlvbiIsImNvcyIsInkiLCJzaW4iLCJCbG9ja3MiLCJibG9ja0NvbG91cnMiLCJpbmRleCIsImJsb2NrQXJyYXkiLCJqIiwicHVzaCIsIm11bHRpSGl0cyIsImJsb2NrSGl0IiwidXBkYXRlU2NvcmUiLCJnYW1lIiwiZHJhdyIsInJlZnJlc2hCbG9ja3MiLCJibG9ja0NvbG9ycyIsImNvbG9yIiwiZ2FtZUNvbXBsZXRlIiwiZ2FtZU92ZXIiLCJyZWN0IiwiYm90dG9tIiwicGFkZGxlSGVpZ2h0IiwicGFkZGxlSGVpZ2h0T2Zmc2V0IiwiYmFsbFN0YXJ0IiwibmV3R2FtZUJ0biIsImNsZWFySW50ZXJ2YWwiLCJtZXNzYWdlMSIsInNldFRpbWVvdXQiLCJtZXNzYWdlMiIsIm1lc3NhZ2UzIiwiZ2V0SXRlbSIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJnZW5lcmF0ZUluaXRpYWxCbG9ja3MiLCJwYWRkbGVTcGVlZCIsImFjY2VsWCIsImFjY2VsWSIsImNsaWVudFkiLCJzdHlsZSIsImRpc3BsYXkiXSwibWFwcGluZ3MiOiI0WEFBQUEsU0FBUUMsSUFBSSxjQUdOQyxpQkFDTCxRQUFBQSxLQUFjQyxnQkFBQUMsS0FBQUYsR0FKZkYsS0FBQUEsT0FBWUssU0FBWkMsZUFBQSxZQU9FRixLQUFLRyxJQUFNQyxPQUFPQyxXQUFXLE1BQzdCTCxLQUxJRixhQUtnQk0sT0FBT0Usd0JBQXdCQyxLQUpwRFAsS0FBQVEsWUFBYyxJQUFBUixLQUFBUyxhQUFBLElBRWJULEtBQUtJLFNBQVNILEdBQ2RELEtBQUtHLE1BQU1DLEdBQUFBLE9BQ1hKLEtBQUtVLFVBQUwsRUFDQVYsS0FBS1EsU0FBTCxFQUdBUixLQUFBVyxXQUFBLEdBQ0FYLEtBQUtZLFlBQUwsR0FDQVosS0FBS2EsT0FBUSxHQUFJQyxRQUFqQmQsS0FBQWEsT0FVQWIsS0FBS2UsT0FBUyxHQUFJQyxTQUFRaEIsS0FBS1EsWUFBYyxLQUFLLEVBQUdSLEtBQUtTLGFBQWUsR0FBSVQsS0FBS0ksUUFKbEZKLEtBQUtpQixLQUFBQSxHQUFMQyxNQUFBbEIsS0FBQVEsWUFBQSxFQUFBLCtEQVlBLElBQUksR0FBSVcsR0FBSSxFQUFHQSxFQUFJbkIsS0FBS29CLE9BQU9D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LFNBQUFDLEdBTUE3RCxHQUFBQSxHQUFTNEQsRUFBQUEsUUFBVG5ELFlBQ0NvRCxHQUFBK0MsT0FDQTlGLFFBQUcrQyxLQUFNQyxJQUdSOUQsU0FBQTRELGlCQUFBLFVBQUEsU0FBQUMsR0FFYUMsSUFMZEQsRUFLUUEsUUFDUC9DLE9BQUFBLE1BQWMyRixZQUlmLElBQUE1QyxFQUFBQyxVQUNBaEQsT0FBRytDLEtBQU1DLGVBSVQ5RCxTQU5ENEQsaUJBQUEsUUFBQSxTQUFBQyxHQVFnQi9DLElBQWZBLEVBQU9hLFNBQVAsSUFBZWtDLEVBQWNsRCxVQUM3QkcsT0FBT2EsS0FBT2IsS0FnR2ZpRixXQUFXbkMsaUJBQWlCLFFBQVMsU0FBU0MsR0FDN0NrQyxXQUFXYyxNQUFNQyxRQUFVLE9BQzNCM0YsT0FBU3FGLHdCQUNUdkQsU0FBVyxFQUNYckMsTUFBUSxFQUNSdUUsS0FBT3BDLFlBQVlxQyxLQUFNekUiLCJmaWxlIjoic2NyaXB0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnNvbGUubG9nKCd3b3JraW5nJyk7XG5cblxuY2xhc3MgR2FtZSB7XG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdC8vIEdhbWUgU2NyZWVuXG5cdFx0dGhpcy5jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm15Q2FudmFzXCIpO1xuXHRcdHRoaXMuY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cdFx0dGhpcy5jYW52YXNPZmZzZXQgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcdFxuXHRcdHRoaXMuY2FudmFzV2lkdGggPSA1MDA7XG5cdFx0dGhpcy5jYW52YXNIZWlnaHQgPSA4MDA7XG5cblx0XHQvLyBHYW1lIFNldHRpbmdzXG5cdFx0dGhpcy5pbnRlcnZhbCA9IDEwO1xuXHRcdHRoaXMuc2NvcmUgPSBuZXcgU2NvcmUoKTtcblx0XHR0aGlzLmhpZ2hTY29yZSA9IDA7XG5cdFx0dGhpcy5udW1MaXZlcyA9IDM7XG5cdFx0XG5cdFx0Ly8gQmxvY2tzIGluaXRpYWxpemVkXG5cdFx0dGhpcy5ibG9ja1dpZHRoID0gNDM7XG5cdFx0dGhpcy5ibG9ja0hlaWdodCA9IDI1O1xuXHRcdHRoaXMuYmxvY2tzID0gIG5ldyBCbG9ja3ModGhpcy5zY29yZSk7XG5cblx0XHQvLyBQYWRkbGUgaW5pdGlhbGl6ZWQgaW4gdGhlIGJvdHRvbSBtaWRkbGUgb2Ygc2NyZWVuXG5cdFx0dGhpcy5wYWRkbGUgPSBuZXcgUGFkZGxlKCh0aGlzLmNhbnZhc1dpZHRoIC0gMTAwKS8yLCB0aGlzLmNhbnZhc0hlaWdodCAtIDQwLCB0aGlzLmNhbnZhcyk7XG5cblx0XHQvLyBCYWxsIGluaXRpYWxpemVkXG5cdFx0dGhpcy5iYWxsID0gbmV3IEJhbGwoKHRoaXMuY2FudmFzV2lkdGgpLzIsIDQwMCk7XG5cdH1cblxuXG5cdGRyYXdCbG9ja3MoKSB7XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuYmxvY2tzLmJsb2NrQXJyLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgYmxvY2sgPSB0aGlzLmJsb2Nrcy5ibG9ja0FycltpXTtcblx0XHRcdGlmKGJsb2NrLmFjdGl2ZSkge1xuXHRcdFx0XHR0aGlzLmN0eC5maWxsU3R5bGUgPSBibG9jay5jb2xvdXI7XG5cdFx0XHRcdHRoaXMuY3R4LmZpbGxSZWN0KGJsb2NrLnBvc1gsIGJsb2NrLnBvc1ksIGJsb2NrLndpZHRoLCBibG9jay5oZWlnaHQpO1xuXHRcdFx0fVx0XG5cdFx0fSAgICAgXG5cdH1cblxuXHRkcmF3UGFkZGxlKCkge1xuXHRcdHRoaXMuY3R4LmZpbGxTdHlsZSA9IHRoaXMucGFkZGxlLmNvbG91cjtcblx0XHR0aGlzLmN0eC5maWxsUmVjdCh0aGlzLnBhZGRsZS5wb3NYLCB0aGlzLnBhZGRsZS5wb3NZLCB0aGlzLnBhZGRsZS53aWR0aCwgdGhpcy5wYWRkbGUuaGVpZ2h0KTtcblxuXHR9XG5cblx0ZHJhd0JhbGwoKSB7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdC8vY2VudGVyKHgseSksIHN0YXJ0IHJhZGlhbiwgZW5kIHJhZGlhblxuXHRcdGN0eC5hcmModGhpcy5iYWxsLnBvc1gsIHRoaXMuYmFsbC5wb3NZLCB0aGlzLmJhbGwucmFkaXVzLCAwICwgMipNYXRoLlBJLCBmYWxzZSk7XG5cdFx0Y3R4LmZpbGxTdHlsZSA9IHRoaXMuYmFsbC5jb2xvdXI7XG5cdFx0Y3R4LmZpbGwoKTtcblx0XHRjdHguc3Ryb2tlKCk7XG5cdH1cblxuXHRkcmF3U2NyZWVuKCkge1xuXHRcdC8vY2xlYXIgY2FudmFzIGJlZm9yZSByZWRyYXdpbmdcblx0XHRjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpO1xuXG5cdFx0dGhpcy5wYWRkbGUudXBkYXRlUG9zaXRpb24oKTtcblx0XHR0aGlzLmJhbGwuYmFsbFBoeXNpY3ModGhpcy5pbnRlcnZhbCwgdGhpcy5jYW52YXNXaWR0aCwgdGhpcy5jYW52YXNIZWlnaHQsIHRoaXMucGFkZGxlLCB0aGlzLmJsb2Nrcyk7XG5cdFx0dGhpcy5ibG9ja3MudXBkYXRlQmxvY2tzKHRoaXMuYmFsbCk7XG5cdFx0dGhpcy5zY29yZS53cml0ZVNjb3JlKCk7XG5cdFx0dGhpcy5kcmF3QmxvY2tzKCk7XG5cdFx0dGhpcy5kcmF3UGFkZGxlKCk7XG5cdFx0dGhpcy5kcmF3QmFsbCgpO1xuXHRcdFxuXHR9XG5cdHN0YXJ0R2FtZSgpIHtcblx0XHR2YXIgdCA9IHRoaXM7XG5cdFx0c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7dC5kcmF3U2NyZWVuKCl9LCB0LmludGVydmFsKTtcblx0fVxufVxuXG5jbGFzcyBTY29yZSB7XG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHRoaXMuc2NvcmUgPSAwO1xuXHRcdHRoaXMubnVtTGl2ZXMgPSAzO1xuXHRcdHRoaXMuaGlnaFNjb3JlID0gMDtcblx0fVxuXHR1cGRhdGVTY29yZShzY29yZSkge1xuXHRcdHRoaXMuc2NvcmUgKz0gc2NvcmU7XG5cdH1cblx0d3JpdGVTY29yZSgpIHtcblx0XHR2YXIgc2NvcmVNZXNzYWdlID0gXCJTY29yZTogXCIgKyB0aGlzLnNjb3JlIFxuXHRcdHZhciBsaXZlTWVzc2FnZSA9IFwiTGl2ZXM6IFwiICsgdGhpcy5udW1MaXZlcztcblx0XHRjdHguZm9udCA9IFwiMzBweCBzYW5zLXNlcmlmXCI7XG5cdFx0Y3R4LmZpbGxUZXh0KHNjb3JlTWVzc2FnZSwgMTAsIDI1KTtcblx0XHRjdHguZmlsbFRleHQobGl2ZU1lc3NhZ2UsIDM1MCwgMjUpO1xuXHR9XG5cdHJlc2V0U2NvcmUoKSB7XG5cdFx0dGhpcy5zY29yZSA9IDA7XG5cdH1cbn1cbmNsYXNzIEJhbGwge1xuXHRjb25zdHJ1Y3Rvcihwb3NYLCBwb3NZKSB7XG5cdFx0dGhpcy5jb2xvdXIgPSAnd2hpdGUnO1xuXHRcdHRoaXMucmFkaXVzID0gMTA7XG5cdFx0dGhpcy5wb3NYID0gcG9zWDtcblx0XHR0aGlzLnBvc1kgPSBwb3NZO1xuXHRcdHRoaXMudmVsWCA9IDA7XG5cdFx0dGhpcy52ZWxZID0gMC4yO1xuXHR9XG5cdC8qIFVwZGF0ZSBiYWxsIHBvc2l0aW9uIG9uIGNhbnZhcyovXG5cdGJhbGxQaHlzaWNzKGludGVydmFsLCBjYW52YXNXaWR0aCwgY2FudmFzSGVpZ2h0LCBwYWRkbGUsIGJsb2Nrcykge1xuXHRcdC8vIFVwZGF0ZSBCYWxsIHBvc2l0aW9uXG5cdFx0dGhpcy5wb3NZICs9IHRoaXMudmVsWSAqIGludGVydmFsO1xuXHRcdHRoaXMucG9zWCArPSB0aGlzLnZlbFggKiBpbnRlcnZhbDtcblx0XG5cdFx0Ly9pZiBiYWxsIGhpdHMgYm90dG9tIHdhbGxcblx0XHRpZih0aGlzLnBvc1kgKyB0aGlzLnJhZGl1cyA+PSBjYW52YXNIZWlnaHQpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdib3R0b20gd2FsbCBoaXQnKTtcblx0XHRcdGxpZmVMb3N0KCk7XG5cdFx0XHR0aGlzLnZlbFkgKj0gLTE7XG5cdFx0fVxuXG5cdFx0Ly9pZiBiYWxsIGhpc3QgdG9wIHdhbGxcblx0XHRpZih0aGlzLnBvc1kgLSB0aGlzLnJhZGl1cyA8PSAwKSB7XG5cdFx0XHRjb25zb2xlLmxvZygndG9wIHdhbGwgaGl0IC1hJyk7XG5cdFx0XHR0aGlzLnZlbFkgKj0gLTE7XG5cdFx0fVxuXG5cdFx0Ly9pZiB2YWxsIGhpdHMgcmlnaHQgd2FsbFxuXHRcdGlmKHRoaXMucG9zWCArIHRoaXMucmFkaXVzID49IGNhbnZhc1dpZHRoKSB7XG5cdFx0XHRjb25zb2xlLmxvZygncmlnaHQgd2FsbCBoaXQgLWEnKTtcblx0XHRcdHRoaXMudmVsWCAqPSAtMTtcblx0XHR9XG5cblx0XHQvL2lmIGJhbGwgaGl0cyBsZWZ0IHdhbGxcblx0XHRpZih0aGlzLnBvc1ggLSB0aGlzLnJhZGl1cyA8PSAwKSB7XG5cdFx0XHRjb25zb2xlLmxvZygnbGVmdCB3YWxsIGhpdCAtYScpO1xuXHRcdFx0dGhpcy52ZWxYICo9IC0xO1xuXHRcdH1cblxuXG5cdFx0Ly9iYWxsIGF0IHBhZGRsZSBsZXZlbFxuXHRcdGlmKHRoaXMucG9zWSA+PSBjYW52YXNIZWlnaHQgLSBwYWRkbGUuaGVpZ2h0IC0gcGFkZGxlLmhlaWdodE9mZnNldCkge1xuXHRcdFx0Ly9iYWxsIGhpdHMgcGFkZGxlXG5cdFx0XHRpZigodGhpcy5wb3NYIC0gdGhpcy5yYWRpdXMgPD0gcGFkZGxlLnBvc1ggKyBwYWRkbGUud2lkdGgpICYmICh0aGlzLnBvc1ggKyB0aGlzLnJhZGl1cyA+PSBwYWRkbGUucG9zWCkpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJwYWRkbGUgaGl0IC1hXCIpO1xuXHRcdFx0XHR0aGlzLnZlbFkgKj0gLTE7XG5cdFx0XHRcdHZhciBzcGVlZCA9IHRoaXMucG9zWC8ocGFkZGxlLnBvc1ggKyAwLjUqcGFkZGxlLndpZHRoKSAtIDE7XG5cdFx0XHRcdHRoaXMudmVsWCA9IHNwZWVkID4gMC41ID8gMC41IDogc3BlZWQ7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdGdldChwcm9wZXJ0eSkge1xuXHRcdHJldHVybiB0aGlzW3Byb3BlcnR5XTtcblx0fVxuXHQvKiBDaGVjayBpZiBiYWxsIGhhcyBoaXQgdGhlIHBhZGRsZSAqL1xuXHQvKiBDaGVjayBpZiBiYWxsIGhhcyBoaXQgYSB3YWxsICovXG5cdC8qIENoZWNrIGlmIGJhbGwgaGFzIGhpdCBhIGJsb2NrICovXG5cbn1cbiBcbmNsYXNzIFBhZGRsZSB7XG5cdGNvbnN0cnVjdG9yKHBvc1gsIHBvc1ksIGNhbnZhcykge1xuXHRcdHRoaXMuY29sb3VyID0gJ2JsYWNrJztcblx0XHR0aGlzLndpZHRoID0gMTAwO1xuXHRcdHRoaXMuaGVpZ2h0ID0gMTU7XG5cdFx0dGhpcy5oZWlnaHRPZmZzZXQgPSA0MDtcblx0XHR0aGlzLnBvc1ggPSBwb3NYO1xuXHRcdHRoaXMucG9zWSA9IHBvc1k7XG5cdFx0dGhpcy52ZWxYID0gMDtcblx0XHR0aGlzLnNwZWVkID0gMC41O1xuXHRcdHRoaXMuY2FudmFzID0gY2FudmFzO1xuXHRcdHRoaXMuY2FudmFzT2Zmc2V0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XHRcblx0XHR2YXIgdCA9IHRoaXM7XG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdFxuXHRcdFx0Ly8gbW92ZSBwYWRkbGUgcG9zIGxlZnQgaWYgbGVmdCBidXR0b24gcHJlc3NlZFxuXHRcdFx0aWYoZXZlbnQua2V5Q29kZSA9PSAzNykge1xuXHRcdFx0XHR0LnZlbFggPSAtdC5zcGVlZDtcblx0XHRcdH1cblx0XHRcdC8vbW92ZSBwYWRkbGUgcG9zIHJpZ2h0IGlmIHJpZ2h0IGJ1dHRvbiBwcmVzc2VkXG5cdFx0XHRlbHNlIGlmKGV2ZW50LmtleUNvZGUgPT0gMzkpIHtcblx0XHRcdFx0dC52ZWxYID0gdC5zcGVlZDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0Ly8gbW92ZSBwYWRkbGUgcG9zIGxlZnQgaWYgbGVmdCBidXR0b24gcHJlc3NlZFxuXHRcdFx0aWYoZXZlbnQua2V5Q29kZSA9PSAzNyB8fCBldmVudC5rZXlDb2RlID09IDM5KSB7XG5cdFx0XHRcdHQudmVsWCA9IDA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9KTtcblxuXHRcdC8vIEV2ZW50IEhhbmRsZXJzIGZvciBwYWRkbGUgY29udHJvbFxuXHRcdHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdHZhciB4ID0gZXZlbnQuY2xpZW50WCAtIHQuY2FudmFzT2Zmc2V0O1xuXHRcdFx0dC5wb3NYID0geDtcblx0XHR9KTtcblx0XHRcblx0fVxuXHRcblx0LyogVXBkYXRlIHBhZGRsZSBwb3NpdGlvbiAqL1xuXHR1cGRhdGVQb3NpdGlvbigpIHtcblx0XHQvLyBjb25zb2xlLmxvZyh0aGlzLnZlbFgpO1xuXHRcdHRoaXMucG9zWCArPSB0aGlzLnZlbFggKiBpbnRlcnZhbDtcblx0XHR0aGlzLnBvc1ggPSB0aGlzLnBvc1ggPj0gY2FudmFzV2lkdGggLSB0aGlzLndpZHRoID8gY2FudmFzV2lkdGggLSB0aGlzLndpZHRoIDogdGhpcy5wb3NYO1xuXHRcdHRoaXMucG9zWCA9IHRoaXMucG9zWCA8PSAwID8gMCA6IHRoaXMucG9zWDtcblx0fVxuXG5cdGdldChwcm9wZXJ0eSkge1xuXHRcdHJldHVybiB0aGlzW3Byb3BlcnR5XTtcblx0fVxuXHRcblx0XG5cdFxufVxuXG5jbGFzcyBCbG9jayB7XG5cdGNvbnN0cnVjdG9yKGlkLCBsZXZlbCwgYWN0aXZlLCBjb2xvdXIsIHBvc1gsIHBvc1ksIHdpZHRoLCBoZWlnaHQpIHtcblx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0dGhpcy5sZXZlbCA9IGxldmVsO1xuXHRcdHRoaXMuYWN0aXZlID0gYWN0aXZlO1xuXHRcdHRoaXMuY29sb3VyID0gY29sb3VyO1xuXHRcdHRoaXMucG9zWCA9IHBvc1g7XG5cdFx0dGhpcy5wb3NZID0gcG9zWTtcblx0XHR0aGlzLndpZHRoID0gd2lkdGg7XG5cdFx0dGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cdH1cblx0Z2V0IChwcm9wZXJ0eSkge1xuXHRcdHJldHVybiB0aGlzW3Byb3BlcnR5XTtcblx0fVxuXG5cdGJsb2NrSGl0KGJhbGwpIHtcblx0XHR2YXIgaGl0ID0gZmFsc2U7XG5cdFx0dmFyIGJsb2NrU2VjdGlvbiA9IHRoaXMucG9zWSArIHRoaXMuaGVpZ2h0O1xuXHRcdFxuXHRcdGlmKGJhbGwucG9zWSAtIGJhbGwucmFkaXVzIDw9IGJsb2NrU2VjdGlvbiAmJiB0aGlzLmFjdGl2ZSkge1xuXHRcdFx0Ly9pdGVyYXRlIG92ZXIgdGhlIGNpcmN1bWZlcmVuY2Ugb2YgdGhlIGJhbGwgYW5kIGNoZWNrIGlmIGFueSBvZiB0aGUgcG9pbnRzIGFyZSBpbnNpZGUgdGhlIHJlY3RhbmdsZVxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IDM2MDsgaSsrKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdFx0XHRcdHZhciB4ID0gYmFsbC5wb3NYICsgYmFsbC5yYWRpdXMgKiBNYXRoLmNvcyhpICogTWF0aC5QSS8xODApO1xuXHRcdFx0XHR2YXIgeSA9IGJhbGwucG9zWSAtICBiYWxsLnJhZGl1cyAqIE1hdGguc2luKGkgKiBNYXRoLlBJLzE4MCk7XG5cblx0XHRcdFx0aWYoeCA+PSB0aGlzLnBvc1ggJiYgeCA8PSB0aGlzLnBvc1ggKyB0aGlzLndpZHRoKSB7XG5cdFx0XHRcdFx0aWYoeSA8PSB0aGlzLnBvc1kgKyB0aGlzLmhlaWdodCAmJiB5ID49IHRoaXMucG9zWSkge1xuXHRcdFx0XHRcdFx0aGl0ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdGJhbGwudmVsWSAqPSAtMTtcblx0XHRcdFx0XHRcdC8vIHNjb3JlICs9ICg0MCAtIDEwKnRoaXMubGV2ZWwgKyAxKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVx0XHRcblx0XHR9XG5cdFx0aWYoaGl0KSB7XG5cdFx0XHR0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSBcblx0XHRyZXR1cm4gZmFsc2U7XHRcblx0fVxufVxuXG5jbGFzcyBCbG9ja3Mge1xuXHRjb25zdHJ1Y3RvcihzY29yZSkge1xuXHRcdHRoaXMuYmxvY2tBcnIgPSB0aGlzLmdlbmVyYXRlQmxvY2tzKCk7XG5cdFx0dGhpcy5zY29yZSA9IHNjb3JlO1xuXHR9XG5cblx0LyogR2VuZXJhdGUgdGhlIGludGlhbCBibG9ja3MgKi9cblx0Z2VuZXJhdGVCbG9ja3MoKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJibG9ja3MgZ2VuZXJhdGVkXCIpO1xuXHRcdHZhciB3aWR0aCA9IDQzO1xuXHRcdHZhciBoZWlnaHQgPSAyNTtcblx0XHR2YXIgcG9zWCA9IDA7XG5cdFx0dmFyIHBvc1kgPSAwO1xuXHRcdHZhciBibG9ja0NvbG91cnMgPSBbJ3JlZCcsICcjMDY0ZGYxJywgJyMzM2YxMDYnLCAnIzgwMzdkZCcsICd5ZWxsb3cnXTtcblx0XHR2YXIgaW5kZXggPSAwO1xuXHRcdHZhciBibG9ja0FycmF5ID0gW11cblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG5cdFx0XHRwb3NYID0gMTI7XG5cdFx0XHRwb3NZICs9IGhlaWdodCArIDU7XG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgMTA7IGorKykge1x0XG5cdFx0XHRcdHZhciBibG9jayA9IG5ldyBCbG9jayhpbmRleCwgaSwgdHJ1ZSwgYmxvY2tDb2xvdXJzW2ldLCBwb3NYLCBwb3NZLCB3aWR0aCwgaGVpZ2h0KTtcblx0XHRcdFx0YmxvY2tBcnJheS5wdXNoKGJsb2NrKTtcblx0XHRcdFx0cG9zWCArPSB3aWR0aCArIDU7XG5cdFx0XHRcdGluZGV4Kys7XG5cdFx0XHR9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdFx0fVxuXHRcdCAgICAgICAgICBcblx0XHQvLyBjb25zb2xlLmxvZyhibG9ja0FycmF5KTtcblx0XHRyZXR1cm4gYmxvY2tBcnJheTsgICAgICAgICAgICAgIFxuXHR9XG5cdHVwZGF0ZUJsb2NrcyhiYWxsKSB7XG5cdFx0dmFyIG11bHRpSGl0cyA9IDA7XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuYmxvY2tBcnIubGVuZ3RoOyBpKyspIHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKHRoaXMuYmxvY2tzQXJyW2ldKTtcblx0XHRcdGlmKHRoaXMuYmxvY2tBcnJbaV0uYWN0aXZlICYmIHRoaXMuYmxvY2tBcnJbaV0uYmxvY2tIaXQoYmFsbCkpIHtcblx0XHRcdFx0bXVsdGlIaXRzKys7XG5cdFx0XHRcdGlmKG11bHRpSGl0cyA+IDEpIGJhbGwudmVsWSAqPSAtMTtcblx0XHRcdFx0dGhpcy5zY29yZS51cGRhdGVTY29yZSg0MCAtIDEwKnRoaXMuYmxvY2tBcnJbaV0ubGV2ZWwgKyAxKTtcblxuXHRcdFx0fVxuXHRcdH1cblx0fSAgIFxuXG5cblx0Z2V0IChwcm9wZXJ0eSkge1xuXHRcdGNvbnNvbGUubG9nKHByb3BlcnR5KVxuXHRcdHJldHVybiB0aGlzW3Byb3BlcnR5XTtcblx0fVxufVxuXG4vLyBEbyBzaGl0IGhlcmVcblxudmFyIGdhbWUgPSBuZXcgR2FtZSgpO1xuZ2FtZS5zdGFydEdhbWUoKTsiLCIvLyBJbml0aWFsaXplIENhbnZhc1xudmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibXlDYW52YXNcIik7XG52YXIgY2FudmFzT2Zmc2V0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XG5jb25zb2xlLmxvZyhcIm9mZnNldC1sZWZ0OiBcIiwgY2FudmFzT2Zmc2V0KTtcbi8vY29uc29sZS5sb2cocmVjdC50b3AsIHJlY3QucmlnaHQsIHJlY3QuYm90dG9tLCByZWN0LmxlZnQpO1xudmFyIGNhbnZhc0hlaWdodCA9IDgwMDsgLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm15Q2FudmFzXCIpLmdldEF0dHJpYnV0ZShcImhlaWdodFwiKTtcbnZhciBjYW52YXNXaWR0aCA9IDUwMDsgLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm15Q2FudmFzXCIpLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpO1xudmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG52YXIgaW50ZXJ2YWwgPSAxMDtcblxuXG4vLyBCbG9jayBQYXJhbWV0ZXJzXG52YXIgYmxvY2tDb2xvcnMgPSBbJ3JlZCcsICcjMDY0ZGYxJywgJyMzM2YxMDYnLCAnIzgwMzdkZCcsICd5ZWxsb3cnXTtcbnZhciBibG9ja1dpZHRoID0gNDM7XG52YXIgYmxvY2tIZWlnaHQgPSAyNTtcbi8vIGRpY3Rpb25hcnkgb2YgYmxvY2sgW3tpZCwgcG9zWCwgcG9zWSwgY29sb3IsIGxldmVsLCBhY3RpdmV9XVxuLy92YXIgYmxvY2tzID0gZ2VuZXJhdGVJbml0aWFsQmxvY2tzKCk7XG5cblxuLy8gUGFkZGxlIFBhcmFtdGVyc1xudmFyIHBhZGRsZUhlaWdodCA9IDE1O1xudmFyIHBhZGRsZUhlaWdodE9mZnNldCA9IDQwO1xudmFyIHBhZGRsZVNwZWVkID0gMC41O1xudmFyIHBhZGRsZSA9IHtwb3NYOiAoY2FudmFzV2lkdGggLSA1MCkvMiwgcG9zWTogY2FudmFzSGVpZ2h0IC0gcGFkZGxlSGVpZ2h0T2Zmc2V0LCB2ZWxYOiAwLCB2ZWxZOiAwLCB3aWR0aDogMTAwLCBoZWlnaHQ6IDE1fTtcblxuLy9iYWxsIHBhcmFtZXRlcnM6IHJhZGl1ZXMsIHgtcG9zaXRpb24sIHktcG9zaXRpb24sIHgtYWNjZWxlcmF0aW9uLCB5LWFjY2VsZXJhdG9pbiwgeC12ZWxvY3R5LCB5LXZlbG9jaXR5XG52YXIgYmFsbFN0YXJ0ID0gMjAwO1xudmFyIGJhbGwgPSB7cmFkaXVzOiAxMCwgcG9zWDogNDAwLCBwb3NZOiBiYWxsU3RhcnQsIGFjY2VsWDogMCwgYWNjZWxZOiAwLCB2ZWxYOiAwLCB2ZWxZOiAwLjJ9O1xuXG4vLyBJbml0aWFsZSBTY29yZVxudmFyIHNjb3JlID0gMDtcbnZhciBudW1MaXZlcyA9IDE7XG52YXIgaGlnaFNjb3JlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJoaWdoU2NvcmVcIikgfHwgMDtcbnZhciBuZXdHYW1lQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZXdHYW1lQnRuXCIpO1xuLy8gUmVkcmF3IGNhbnZhcyAyMHgvcyAtPjEvNjAgPSAwLjA1cyA9IDUwbXNcbi8vdmFyIGdhbWUgPSBzZXRJbnRlcnZhbChkcmF3LCBpbnRlcnZhbCk7XG5cbmZ1bmN0aW9uIGRyYXcoKSB7XG5cdC8vY2xlYXIgY2FudmFzIGJlZm9yZSByZWRyYXdpbmdcblx0Y3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXNXaWR0aCwgY2FudmFzSGVpZ2h0KTtcblxuXHQvL2RyYXcgcGFkZGxlXG5cdGN0eC5maWxsU3R5bGUgPSAnYmxhY2snO1xuXHRwYWRkbGVQb3NpdGlvbigpO1xuXHQvL3BhZGRsZS5wb3NYICs9IHBhZGRsZS52ZWxYKmludGVydmFsO1xuXHQvL3BhZGRsZS52ZWxYID0gMDtcblx0Y3R4LmZpbGxSZWN0KHBhZGRsZS5wb3NYLCBwYWRkbGUucG9zWSwgcGFkZGxlLndpZHRoLCBwYWRkbGUuaGVpZ2h0KTtcblxuXHRcblx0XG5cdGJhbGxQaHlzaWNzKCk7XG5cdHJlZnJlc2hCbG9ja3MoYmxvY2tzKTtcblxuXHRjdHguYmVnaW5QYXRoKCk7XG5cdC8vZHJhdyBiYWxsXG5cblx0Ly9jZW50ZXIoeCx5KSwgc3RhcnQgcmFkaWFuLCBlbmQgcmFkaWFuXG5cdGN0eC5hcmMoYmFsbC5wb3NYLCBiYWxsLnBvc1ksIGJhbGwucmFkaXVzLCAwICwgMipNYXRoLlBJLCBmYWxzZSk7XG5cdGN0eC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XG5cdGN0eC5maWxsKCk7XG5cdGN0eC5zdHJva2UoKTtcblxuXHQvLyBTY29yZVxuXHR1cGRhdGVTY29yZSgpO1xuXG5cbn1cblxuLy8gZ2VuZXJhdGUgYmxvY2tzIG9uIGNhbnZhcyBhbmQgcHVzaCBpbnRvIGJsb2NrIGRpY3Rpb25hcnlcbmZ1bmN0aW9uIGdlbmVyYXRlSW5pdGlhbEJsb2NrcygpIHtcblx0dmFyIHdpZHRoID0gYmxvY2tXaWR0aDtcblx0dmFyIGhlaWdodCA9IGJsb2NrSGVpZ2h0O1xuXHR2YXIgcG9zWCA9IDA7XG5cdHZhciBwb3NZID0gMDtcblxuXHR2YXIgaW5kZXggPSAwO1xuXHR2YXIgYmxvY2tBcnJheSA9IFtdXG5cdGZvcih2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcblx0XHRwb3NYID0gMTI7XG5cdFx0cG9zWSArPSBoZWlnaHQgKyA1O1xuXHRcdGZvcih2YXIgaiA9IDA7IGogPCAxMDsgaisrKSB7XHRcblx0XHRcdGN0eC5maWxsU3R5bGUgPSBibG9ja0NvbG9yc1tpXTtcblx0XHRcdGN0eC5maWxsUmVjdChwb3NYLCBwb3NZLCB3aWR0aCwgaGVpZ2h0KTtcblx0XHRcdGJsb2NrQXJyYXkucHVzaCh7aWQ6IGluZGV4LCBwb3NYOiBwb3NYLCBwb3NZOiBwb3NZLCBjb2xvcjogYmxvY2tDb2xvcnNbaV0sIGxldmVsOiBpLCBhY3RpdmU6IHRydWV9KTtcblx0XHRcdHBvc1ggKz0gd2lkdGggKyA1O1xuXHRcdFx0aW5kZXgrKztcblx0XHR9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdH0gICAgICAgICAgICAgXG5cdHJldHVybiBibG9ja0FycmF5OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxufVxuXG4vL3JlcmVuZGVyIGJsb2Nrc1xuZnVuY3Rpb24gcmVmcmVzaEJsb2NrcyhibG9ja0FycmF5KSB7XG5cdHZhciBtdWx0aUhpdHMgPSAwO1xuXHRmb3IodmFyIGkgPSAwOyBpIDwgYmxvY2tBcnJheS5sZW5ndGg7IGkrKykge1xuXHRcdC8vY2hlY2sgaWYgYmxvY2sgaGl0IGJ5IGJhbGxcblx0XHQvL2lmIGJhbGwgaGl0cyBtdWx0aXBsZSBibG9ja3MgYXQgc2FtZSB0aW1lLCB3YW50IHRvIGNhbmNlbCB0aGUgZG91YmxlIG5lZ2F0aW9uXG5cdFx0aWYoYmxvY2tIaXQoYmxvY2tBcnJheVtpXSkpIHtcblx0XHRcdGlmKGdhbWVDb21wbGV0ZSgpKSBnYW1lT3ZlcigpO1xuXHRcdFx0bXVsdGlIaXRzKys7XG5cdFx0XHRpZihtdWx0aUhpdHMgPiAxKSBiYWxsLnZlbFkgKj0gLTE7XG5cdFx0fVxuXHRcdFxuXHRcdC8vb25seSByZW5kZXIgYmxvY2tzIHRoYXQgaGF2ZSBiZWVuIGhpdFxuXHRcdGlmKGJsb2NrQXJyYXlbaV0uYWN0aXZlKSB7XG5cdFx0XHRjdHguZmlsbFN0eWxlID0gYmxvY2tBcnJheVtpXS5jb2xvcjtcblx0XHRcdGN0eC5maWxsUmVjdChibG9ja0FycmF5W2ldLnBvc1gsIGJsb2NrQXJyYXlbaV0ucG9zWSwgYmxvY2tXaWR0aCwgYmxvY2tIZWlnaHQpO1xuXHRcdH1cdFx0XG5cdH1cbn1cblxuLy8gQ2hlY2sgaWYgYmFsbCBoaXRzIGJsb2NrIGhlbHBlciBtZXRob2RcbmZ1bmN0aW9uIGJsb2NrSGl0KHJlY3QpIHtcblx0dmFyIGhpdCA9IGZhbHNlO1xuXHR2YXIgYmxvY2tTZWN0aW9uID0gYmxvY2tzW2Jsb2Nrcy5sZW5ndGggLTEgXS5wb3NZICsgYmxvY2tIZWlnaHQ7XG5cdC8vaWYgYmFsbCBpcyBpbiB0aGUgdG9wIG9mIHRoZSBzY3JlZW5cblxuXHRpZihiYWxsLnBvc1kgLSBiYWxsLnJhZGl1cyA8PSBibG9ja1NlY3Rpb24gJiYgcmVjdC5hY3RpdmUpIHtcblx0XHR2YXIgdG9wID0ge3g6IGJhbGwucG9zWCwgeTogYmFsbC5wb3NZIC0gYmFsbC5yYWRpdXN9O1xuXHRcdHZhciByaWdodCA9IHt4OiBiYWxsLnBvc1ggKyBiYWxsLnJhZGl1cywgeTogYmFsbC5wb3NZfTtcblx0XHR2YXIgYm90dG9tID0ge3g6IGJhbGwucG9zWCwgeTogYmFsbC5wb3NZICsgYmFsbC5yYWRpdXN9O1xuXHRcdHZhciBsZWZ0ID0ge3g6IGJhbGwucG9zWCAtIGJhbGwucmFkaXVzLCB5OiBiYWxsLnBvc1l9O1xuXHRcdC8vaXRlcmF0ZSBvdmVyIHRoZSBjaXJjdW1mZXJlbmNlIG9mIHRoZSBiYWxsIGFuZCBjaGVjayBpZiBhbnkgb2YgdGhlIHBvaW50cyBhcmUgaW5zaWRlIHRoZSByZWN0YW5nbGVcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgMzYwOyBpKyspIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblx0XHRcdHZhciB4ID0gYmFsbC5wb3NYICsgYmFsbC5yYWRpdXMgKiBNYXRoLmNvcyhpICogTWF0aC5QSS8xODApO1xuXHRcdFx0dmFyIHkgPSBiYWxsLnBvc1kgLSAgYmFsbC5yYWRpdXMgKiBNYXRoLnNpbihpICogTWF0aC5QSS8xODApO1xuXG5cdFx0XHRpZih4ID49IHJlY3QucG9zWCAmJiB4IDw9IHJlY3QucG9zWCArIGJsb2NrV2lkdGgpIHtcblx0XHRcdFx0aWYoeSA8PSByZWN0LnBvc1kgKyBibG9ja0hlaWdodCAmJiB5ID49IHJlY3QucG9zWSkge1xuXHRcdFx0XHRcdGhpdCA9IHRydWU7XG5cdFx0XHRcdFx0YmFsbC52ZWxZICo9IC0xO1xuXHRcdFx0XHRcdHNjb3JlICs9ICg0MCAtIDEwKnJlY3QubGV2ZWwgKyAxKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cdFx0XG5cdH1cblx0aWYoaGl0KSB7XG5cdFx0YmxvY2tzW3JlY3QuaWRdLmFjdGl2ZSA9IGZhbHNlO1xuXHRcdHJldHVybiB0cnVlXG5cdH0gXG5cdHJldHVybiBmYWxzZTtcdFxufVxuXG5cblxuLy8gRXZlbnQgSGFuZGxlcnMgZm9yIHBhZGRsZSBjb250cm9sXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbihldmVudCkge1xuXHR2YXIgeCA9IGV2ZW50LmNsaWVudFggLSBjYW52YXNPZmZzZXQ7XG5cdHZhciB5ID0gZXZlbnQuY2xpZW50WTtcblx0cGFkZGxlLnBvc1ggPSB4O1xuXHQvL2NvbnNvbGUubG9nKCdtOiAnLCB4KTtcbn0pO1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24oZXZlbnQpIHtcblx0Ly8gbW92ZSBwYWRkbGUgcG9zIGxlZnQgaWYgbGVmdCBidXR0b24gcHJlc3NlZFxuXHRpZihldmVudC5rZXlDb2RlID09IDM3KSB7XG5cdFx0cGFkZGxlLnZlbFggPSAtcGFkZGxlU3BlZWQ7XG5cdFx0Ly8gY29uc29sZS5sb2coJ3QnKTtcblx0fVxuXHQvL21vdmUgcGFkZGxlIHBvcyByaWdodCBpZiByaWdodCBidXR0b24gcHJlc3NlZFxuXHRlbHNlIGlmKGV2ZW50LmtleUNvZGUgPT0gMzkpIHtcblx0XHRwYWRkbGUudmVsWCA9IHBhZGRsZVNwZWVkO1xuXHR9XG59KTtcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBmdW5jdGlvbihldmVudCkge1xuXHQvLyBtb3ZlIHBhZGRsZSBwb3MgbGVmdCBpZiBsZWZ0IGJ1dHRvbiBwcmVzc2VkXG5cdGlmKGV2ZW50LmtleUNvZGUgPT0gMzcgfHwgZXZlbnQua2V5Q29kZSA9PSAzOSkge1xuXHRcdHBhZGRsZS52ZWxYID0gMDtcblx0fVxuXHRcbn0pO1xuZnVuY3Rpb24gcGFkZGxlUG9zaXRpb24oKSB7XG5cdHBhZGRsZS5wb3NYICs9IHBhZGRsZS52ZWxYICogaW50ZXJ2YWw7XG5cdHBhZGRsZS5wb3NYID0gcGFkZGxlLnBvc1ggPj0gY2FudmFzV2lkdGggLSBwYWRkbGUud2lkdGggPyBjYW52YXNXaWR0aCAtIHBhZGRsZS53aWR0aCA6IHBhZGRsZS5wb3NYO1xuXHRwYWRkbGUucG9zWCA9IHBhZGRsZS5wb3NYIDw9IDAgPyAwIDogcGFkZGxlLnBvc1g7XG59XG5cblxuXG5mdW5jdGlvbiBiYWxsUGh5c2ljcygpIHtcblxuXHQvLyBVcGRhdGUgQmFsbCBwb3NpdGlvblxuXHRiYWxsLnBvc1kgKz0gYmFsbC52ZWxZICogaW50ZXJ2YWw7XG5cdGJhbGwucG9zWCArPSBiYWxsLnZlbFggKiBpbnRlcnZhbDtcblx0XG5cdC8vaWYgYmFsbCBoaXRzIGJvdHRvbSB3YWxsXG5cdGlmKGJhbGwucG9zWSArIGJhbGwucmFkaXVzID49IGNhbnZhc0hlaWdodCkge1xuXHRcdGNvbnNvbGUubG9nKCdib3R0b20gd2FsbCBoaXQnKTtcblx0XHRsaWZlTG9zdCgpO1xuXHRcdC8vYmFsbC52ZWxZICo9IC0xO1xuXHR9XG5cblx0Ly9pZiBiYWxsIGhpc3QgdG9wIHdhbGxcblx0aWYoYmFsbC5wb3NZIC0gYmFsbC5yYWRpdXMgPD0gMCkge1xuXHRcdGNvbnNvbGUubG9nKCd0b3Agd2FsbCBoaXQnKTtcblx0XHRiYWxsLnZlbFkgKj0gLTE7XG5cdH1cblxuXHQvL2lmIHZhbGwgaGl0cyByaWdodCB3YWxsXG5cdGlmKGJhbGwucG9zWCArIGJhbGwucmFkaXVzID49IGNhbnZhc1dpZHRoKSB7XG5cdFx0Y29uc29sZS5sb2coJ3JpZ2h0IHdhbGwgaGl0Jyk7XG5cdFx0YmFsbC52ZWxYICo9IC0xO1xuXHR9XG5cblx0Ly9pZiBiYWxsIGhpdHMgbGVmdCB3YWxsXG5cdGlmKGJhbGwucG9zWCAtIGJhbGwucmFkaXVzIDw9IDApIHtcblx0XHRjb25zb2xlLmxvZygnbGVmdCB3YWxsIGhpdCcpO1xuXHRcdGJhbGwudmVsWCAqPSAtMTtcblx0fVxuXG5cblx0Ly9iYWxsIGF0IHBhZGRsZSBsZXZlbFxuXHRpZihiYWxsLnBvc1kgPj0gY2FudmFzSGVpZ2h0IC0gcGFkZGxlSGVpZ2h0IC0gcGFkZGxlSGVpZ2h0T2Zmc2V0KSB7XG5cdFx0Ly9iYWxsIGhpdHMgcGFkZGxlXG5cdFx0aWYoKGJhbGwucG9zWCAtIGJhbGwucmFkaXVzIDw9IHBhZGRsZS5wb3NYICsgcGFkZGxlLndpZHRoKSAmJiAoYmFsbC5wb3NYICsgYmFsbC5yYWRpdXMgPj0gcGFkZGxlLnBvc1gpKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcInBhZGRsZSBoaXRcIik7XG5cdFx0XHRiYWxsLnZlbFkgKj0gLTE7XG5cdFx0XHR2YXIgc3BlZWQgPSBiYWxsLnBvc1gvKHBhZGRsZS5wb3NYICsgMC41KnBhZGRsZS53aWR0aCkgLSAxO1xuXHRcdFx0YmFsbC52ZWxYID0gc3BlZWQgPiAwLjUgPyAwLjUgOiBzcGVlZDsxMFxuXHRcdH1cblx0fVxufVxuZnVuY3Rpb24gdXBkYXRlU2NvcmUoKSB7XG5cdHZhciBzY29yZU1lc3NhZ2UgPSBcIlNjb3JlOiBcIiArIHNjb3JlIFxuXHR2YXIgbGl2ZU1lc3NhZ2UgPSBcIkxpdmVzOiBcIiArIG51bUxpdmVzO1xuXHRjdHguZm9udCA9IFwiMzBweCBzYW5zLXNlcmlmXCI7XG5cdGN0eC5maWxsVGV4dChzY29yZU1lc3NhZ2UsIDEwLCA1MCk7XG5cdGN0eC5maWxsVGV4dChsaXZlTWVzc2FnZSwgMzUwLCA1MCk7XG5cdFxufVxuZnVuY3Rpb24gbGlmZUxvc3QoKSB7XG5cdG51bUxpdmVzLS07XG5cdGlmKG51bUxpdmVzID09IDApIHtcblx0XHRnYW1lT3ZlcigpO1xuXHR9XG5cdGJhbGwucG9zWSA9IGJhbGxTdGFydDtcbn1cblxuZnVuY3Rpb24gZ2FtZUNvbXBsZXRlKCkge1xuXHRmb3IodmFyIGkgPSAwOyBpIDwgYmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0aWYoYmxvY2tzW2ldLmFjdGl2ZSkgcmV0dXJuIGZhbHNlO1xuXHR9XG5cdHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gZ2FtZU92ZXIoKSB7XG5cdGNvbnNvbGUubG9nKFwiR2FtZSBPdmVyXCIpO1xuXHRjbGVhckludGVydmFsKGdhbWUpO1xuXHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdC8vIENsZWFyIENhbnZhc1xuXHRcdGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzV2lkdGgsIGNhbnZhc0hlaWdodCk7XG5cblx0XHRcblxuXHRcdHZhciBjdXJySGlnaFNjb3JlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJoaWdoU2NvcmVcIik7XG5cdFx0c2NvcmUgPiAgY3VyckhpZ2hTY29yZSA/IGhpZ2hTY29yZSA9IHNjb3JlIDogaGlnaFNjb3JlO1xuXHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiaGlnaFNjb3JlXCIsIGhpZ2hTY29yZSk7XG5cdFx0bmV3R2FtZUJ0bi5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmVcIjtcblx0XHRcblx0XHR2YXIgbWVzc2FnZTEgPSBcIkdBTUUgT1ZFUlwiO1xuXHRcdHZhciBtZXNzYWdlMiA9IFwiWW91ciBTY29yZTogXCIgKyBzY29yZTsgXG5cdFx0dmFyIG1lc3NhZ2UzID0gXCJZb3VyIEhpZ2ggc2NvcmU6IFwiICsgaGlnaFNjb3JlO1xuXHRcdFxuXHRcdGN0eC5mb250ID0gXCIzMHB4IHNhbnMtc2VyaWZcIjtcblx0XHRjdHguZmlsbFRleHQobWVzc2FnZTEsIDE1MCwgNTApO1xuXHRcdGN0eC5maWxsVGV4dChtZXNzYWdlMiwgMTUwLCAxNTApO1xuXHRcdGN0eC5maWxsVGV4dChtZXNzYWdlMywgMTUwLCAyMDApO1xuXHR9LCBpbnRlcnZhbCk7XG5cdFxufVxubmV3R2FtZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZXZlbnQpIHtcblx0bmV3R2FtZUJ0bi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cdGJsb2NrcyA9IGdlbmVyYXRlSW5pdGlhbEJsb2NrcygpO1xuXHRudW1MaXZlcyA9IDE7XG5cdHNjb3JlID0gMDtcblx0Z2FtZSA9IHNldEludGVydmFsKGRyYXcsIGludGVydmFsKTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
