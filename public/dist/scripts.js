"use strict";function draw(){ctx.clearRect(0,0,canvasWidth,canvasHeight),ctx.fillStyle="black",paddlePosition(),ctx.fillRect(paddle.posX,paddle.posY,paddle.width,paddle.height),ballPhysics(),refreshBlocks(blocks),ctx.beginPath(),ctx.arc(ball.posX,ball.posY,ball.radius,0,2*Math.PI,!1),ctx.fillStyle="white",ctx.fill(),ctx.stroke(),updateScore()}function generateInitialBlocks(){for(var l=blockWidth,e=blockHeight,a=0,t=0,o=0,s=[],i=0;i<5;i++){a=12,t+=e+5;for(var c=0;c<10;c++)ctx.fillStyle=blockColors[i],ctx.fillRect(a,t,l,e),s.push({id:o,posX:a,posY:t,color:blockColors[i],level:i,active:!0}),a+=l+5,o++}return s}function refreshBlocks(l){for(var e=0,a=0;a<l.length;a++)blockHit(l[a])&&(gameComplete()&&gameOver(),e++,e>1&&(ball.velY*=-1)),l[a].active&&(ctx.fillStyle=l[a].color,ctx.fillRect(l[a].posX,l[a].posY,blockWidth,blockHeight))}function blockHit(l){var e=!1,a=blocks[blocks.length-1].posY+blockHeight;if(ball.posY-ball.radius<=a&&l.active)for(var t=({x:ball.posX,y:ball.posY-ball.radius},{x:ball.posX+ball.radius,y:ball.posY},{x:ball.posX,y:ball.posY+ball.radius},{x:ball.posX-ball.radius,y:ball.posY},0);t<360;t++){var o=ball.posX+ball.radius*Math.cos(t*Math.PI/180),s=ball.posY-ball.radius*Math.sin(t*Math.PI/180);if(o>=l.posX&&o<=l.posX+blockWidth&&s<=l.posY+blockHeight&&s>=l.posY){e=!0,ball.velY*=-1,score+=40-10*l.level+1;break}}return!!e&&(blocks[l.id].active=!1,!0)}function paddlePosition(){paddle.posX+=paddle.velX*interval,paddle.posX=paddle.posX>=canvasWidth-paddle.width?canvasWidth-paddle.width:paddle.posX,paddle.posX=paddle.posX<=0?0:paddle.posX}function ballPhysics(){if(ball.posY+=ball.velY*interval,ball.posX+=ball.velX*interval,ball.posY+ball.radius>=canvasHeight&&(console.log("bottom wall hit"),lifeLost()),ball.posY-ball.radius<=0&&(console.log("top wall hit"),ball.velY*=-1),ball.posX+ball.radius>=canvasWidth&&(console.log("right wall hit"),ball.velX*=-1),ball.posX-ball.radius<=0&&(console.log("left wall hit"),ball.velX*=-1),ball.posY>=canvasHeight-paddleHeight-paddleHeightOffset&&ball.posX-ball.radius<=paddle.posX+paddle.width&&ball.posX+ball.radius>=paddle.posX){console.log("paddle hit"),ball.velY*=-1;var l=ball.posX/(paddle.posX+.5*paddle.width)-1;ball.velX=l>.5?.5:l}}function updateScore(){var l="Score: "+score,e="Lives: "+numLives;ctx.font="30px sans-serif",ctx.fillText(l,10,50),ctx.fillText(e,350,50)}function lifeLost(){numLives--,0==numLives&&gameOver(),ball.posY=ballStart}function gameComplete(){for(var l=0;l<blocks.length;l++)if(blocks[l].active)return!1;return!0}function gameOver(){console.log("Game Over"),clearInterval(game),setTimeout(function(){ctx.clearRect(0,0,canvasWidth,canvasHeight);var l=localStorage.getItem("highScore");score>l?highScore=score:highScore,localStorage.setItem("highScore",highScore),newGameBtn.style.display="inline";var e="GAME OVER",a="Your Score: "+score,t="Your High score: "+highScore;ctx.font="30px sans-serif",ctx.fillText(e,150,50),ctx.fillText(a,150,150),ctx.fillText(t,150,200)},interval)}var canvas=document.getElementById("myCanvas"),canvasOffset=canvas.getBoundingClientRect().left;console.log("offset-left: ",canvasOffset);var canvasHeight=800,canvasWidth=500,ctx=canvas.getContext("2d"),interval=10,blockColors=["red","#064df1","#33f106","#8037dd","yellow"],blockWidth=43,blockHeight=25,paddleHeight=15,paddleHeightOffset=40,paddleSpeed=.5,paddle={posX:(canvasWidth-50)/2,posY:canvasHeight-paddleHeightOffset,velX:0,velY:0,width:100,height:15},ballStart=200,ball={radius:10,posX:400,posY:ballStart,accelX:0,accelY:0,velX:0,velY:.2},score=0,numLives=1,highScore=localStorage.getItem("highScore")||0,newGameBtn=document.getElementById("newGameBtn");canvas.addEventListener("mousemove",function(l){var e=l.clientX-canvasOffset;l.clientY;paddle.posX=e}),document.addEventListener("keydown",function(l){37==l.keyCode?paddle.velX=-paddleSpeed:39==l.keyCode&&(paddle.velX=paddleSpeed)}),document.addEventListener("keyup",function(l){37!=l.keyCode&&39!=l.keyCode||(paddle.velX=0)}),newGameBtn.addEventListener("click",function(l){newGameBtn.style.display="none",blocks=generateInitialBlocks(),numLives=1,score=0,game=setInterval(draw,interval)});
"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,s){for(var i=0;i<s.length;i++){var e=s[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(s,i,e){return i&&t(s.prototype,i),e&&t(s,e),s}}();console.log("working");var Game=function(){function t(){_classCallCheck(this,t),this.canvas=document.getElementById("myCanvas"),this.ctx=canvas.getContext("2d"),this.canvasOffset=canvas.getBoundingClientRect().left,this.canvasWidth=500,this.canvasHeight=800,this.interval=10,this.score=0,this.highScore=0,this.numLives=3,this.blockWidth=43,this.blockHeight=25,this.blocks=new Blocks,this.paddle=new Paddle((this.canvasWidth-100)/2,this.canvasHeight-40,this.canvas),this.ball=new Ball(this.canvasWidth/2,400)}return _createClass(t,[{key:"drawBlocks",value:function(){for(var t=0;t<this.blocks.blockArr.length;t++){var s=this.blocks.blockArr[t];s.active&&(this.ctx.fillStyle=s.colour,this.ctx.fillRect(s.posX,s.posY,s.width,s.height))}}},{key:"drawPaddle",value:function(){this.ctx.fillStyle=this.paddle.colour,this.ctx.fillRect(this.paddle.posX,this.paddle.posY,this.paddle.width,this.paddle.height)}},{key:"drawBall",value:function(){ctx.beginPath(),ctx.arc(this.ball.posX,this.ball.posY,this.ball.radius,0,2*Math.PI,!1),ctx.fillStyle=this.ball.colour,ctx.fill(),ctx.stroke()}},{key:"drawScreen",value:function(){ctx.clearRect(0,0,canvasWidth,canvasHeight),this.paddle.updatePosition(),this.ball.ballPhysics(this.interval,this.canvasWidth,this.canvasHeight,this.paddle,this.blocks),this.blocks.updateBlocks(this.ball),this.drawBlocks(),this.drawPaddle(),this.drawBall()}},{key:"startGame",value:function(){var t=this;setInterval(function(){t.drawScreen()},t.interval)}}]),t}(),Ball=function(){function t(s,i){_classCallCheck(this,t),this.colour="white",this.radius=10,this.posX=s,this.posY=i,this.velX=0,this.velY=.2}return _createClass(t,[{key:"ballPhysics",value:function(t,s,i,e,a){if(this.posY+=this.velY*t,this.posX+=this.velX*t,this.posY+this.radius>=i&&(console.log("bottom wall hit"),lifeLost(),this.velY*=-1),this.posY-this.radius<=0&&(console.log("top wall hit -a"),this.velY*=-1),this.posX+this.radius>=s&&(console.log("right wall hit -a"),this.velX*=-1),this.posX-this.radius<=0&&(console.log("left wall hit -a"),this.velX*=-1),this.posY>=i-e.height-e.heightOffset&&this.posX-this.radius<=e.posX+e.width&&this.posX+this.radius>=e.posX){console.log("paddle hit -a"),this.velY*=-1;var h=this.posX/(e.posX+.5*e.width)-1;this.velX=h>.5?.5:h}}},{key:"get",value:function(t){return this[t]}}]),t}(),Paddle=function(){function t(s,i,e){_classCallCheck(this,t),this.colour="black",this.width=100,this.height=15,this.heightOffset=40,this.posX=s,this.posY=i,this.velX=0,this.speed=.5,this.canvas=e,this.canvasOffset=e.getBoundingClientRect().left;var a=this;document.addEventListener("keydown",function(t){37==t.keyCode?a.velX=-a.speed:39==t.keyCode&&(a.velX=a.speed)}),document.addEventListener("keyup",function(t){37!=t.keyCode&&39!=t.keyCode||(a.velX=0)}),this.canvas.addEventListener("mousemove",function(t){var s=t.clientX-a.canvasOffset;a.posX=s})}return _createClass(t,[{key:"updatePosition",value:function(){this.posX+=this.velX*interval,this.posX=this.posX>=canvasWidth-this.width?canvasWidth-this.width:this.posX,this.posX=this.posX<=0?0:this.posX}},{key:"get",value:function(t){return this[t]}}]),t}(),Block=function(){function t(s,i,e,a,h,l,o,n){_classCallCheck(this,t),this.id=s,this.level=i,this.active=e,this.colour=a,this.posX=h,this.posY=l,this.width=o,this.height=n}return _createClass(t,[{key:"get",value:function(t){return this[t]}},{key:"blockHit",value:function(t){var s=!1,i=this.posY+this.height;if(t.posY-t.radius<=i&&this.active)for(var e=0;e<360;e++){var a=t.posX+t.radius*Math.cos(e*Math.PI/180),h=t.posY-t.radius*Math.sin(e*Math.PI/180);if(a>=this.posX&&a<=this.posX+this.width&&h<=this.posY+this.height&&h>=this.posY){s=!0,t.velY*=-1,score+=40-10*this.level+1;break}}return!!s&&(this.active=!1,!0)}}]),t}(),Blocks=function(){function t(){_classCallCheck(this,t),this.blockArr=this.generateBlocks()}return _createClass(t,[{key:"generateBlocks",value:function(){for(var t=43,s=25,i=0,e=0,a=["red","#064df1","#33f106","#8037dd","yellow"],h=0,l=[],o=0;o<5;o++){i=12,e+=s+5;for(var n=0;n<10;n++){var c=new Block(h,o,(!0),a[o],i,e,t,s);l.push(c),i+=t+5,h++}}return l}},{key:"updateBlocks",value:function(t){for(var s=0,i=0;i<this.blockArr.length;i++)this.blockArr[i].blockHit(t)&&(s++,s>1&&(t.velY*=-1))}},{key:"get",value:function(t){return console.log(t),this[t]}}]),t}(),game=new Game;game.startGame();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJyZWFrb3V0LmpzIiwidGVzdC5qcyJdLCJuYW1lcyI6WyJkcmF3IiwiY3R4IiwiY2xlYXJSZWN0IiwiY2FudmFzV2lkdGgiLCJjYW52YXNIZWlnaHQiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsInBhZGRsZSIsInBvc1giLCJwb3NZIiwid2lkdGgiLCJoZWlnaHQiLCJyZWZyZXNoQmxvY2tzIiwiYmxvY2tzIiwiYmVnaW5QYXRoIiwiYmFsbCIsInJhZGl1cyIsIk1hdGgiLCJQSSIsImZpbGwiLCJzdHJva2UiLCJ1cGRhdGVTY29yZSIsImJsb2NrV2lkdGgiLCJibG9ja0hlaWdodCIsImluZGV4IiwiYmxvY2tBcnJheSIsImkiLCJqIiwicHVzaCIsImlkIiwiYmxvY2tDb2xvcnMiLCJjb2xvciIsImxldmVsIiwiYWN0aXZlIiwibXVsdGlIaXRzIiwiYmxvY2tIaXQiLCJsZW5ndGgiLCJnYW1lQ29tcGxldGUiLCJnYW1lT3ZlciIsInZlbFkiLCJyZWN0IiwiaGl0IiwiYmxvY2tTZWN0aW9uIiwiYm90dG9tIiwieSIsIngiLCJjb3MiLCJzY29yZSIsImJhbGxQaHlzaWNzIiwidmVsWCIsImludGVydmFsIiwiY29uc29sZSIsImxpZmVMb3N0IiwibG9nIiwicGFkZGxlSGVpZ2h0IiwicGFkZGxlSGVpZ2h0T2Zmc2V0Iiwic2NvcmVNZXNzYWdlIiwibGl2ZU1lc3NhZ2UiLCJmb250IiwiZmlsbFRleHQiLCJzcGVlZCIsIm51bUxpdmVzIiwiYmFsbFN0YXJ0IiwibmV3R2FtZUJ0biIsImNsZWFySW50ZXJ2YWwiLCJtZXNzYWdlMSIsInNldFRpbWVvdXQiLCJtZXNzYWdlMiIsIm1lc3NhZ2UzIiwiZ2V0SXRlbSIsImhpZ2hTY29yZSIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJhZGRFdmVudExpc3RlbmVyIiwiZ2VuZXJhdGVJbml0aWFsQmxvY2tzIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNhbnZhc09mZnNldCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImxlZnQiLCJwYWRkbGVTcGVlZCIsImFjY2VsWCIsImFjY2VsWSIsImV2ZW50IiwiY2xpZW50WSIsImtleUNvZGUiLCJzdHlsZSIsImRpc3BsYXkiLCJnYW1lIiwic2V0SW50ZXJ2YWwiLCJHYW1lIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsImdldENvbnRleHQiLCJCbG9ja3MiLCJQYWRkbGUiLCJCYWxsIiwiYmxvY2tBcnIiLCJibG9jayIsImNvbG91ciIsImFyYyIsInVwZGF0ZUJsb2NrcyIsImRyYXdCbG9ja3MiLCJkcmF3UGFkZGxlIiwiZHJhd0JhbGwiLCJ0IiwidXBkYXRlUG9zaXRpb24iLCJoZWlnaHRPZmZzZXQiLCJwcm9wZXJ0eSIsIkJsb2NrIiwic2luIiwiZ2VuZXJhdGVCbG9ja3MiLCJibG9ja0NvbG91cnMiLCJzdGFydEdhbWUiXSwibWFwcGluZ3MiOiJZQXFDQSxTQUFTQSxRQUNSQyxJQUFBQyxVQUFBLEVBQUEsRUFBQUMsWUFBQUMsY0FHQUgsSUFBQUksVUFBQSxRQUNBSixpQkFHQUEsSUFBQUssU0FBQUMsT0FBQUMsS0FBQUQsT0FBQUUsS0FBQUYsT0FBQUcsTUFBQUgsT0FBQUksUUFNQUMsY0FBQUEsY0FBY0MsUUFHZFosSUFBQWEsWUFJQWIsSUFBSUksSUFBQUEsS0FBSkcsS0FBZ0JPLEtBQWhCTixLQUFBTSxLQUFBQyxPQUFBLEVBQUEsRUFBQUMsS0FBQUMsSUFBQSxHQUNBakIsSUFBSWtCLFVBQUosUUFDQWxCLElBQUltQixPQUFKbkIsSUFBSW1CLFNBTUpDLGNBTUEsUUFBSWIseUJBUUgsSUFBQSxHQVBHQyxHQUFKYSxXQUZJWCxFQUFTWSxZQUlUQyxFQUFBQSxFQUNBQyxFQUFBQSxFQUVIakIsRUFBQSxFQUNBQyxLQUNJaUIsRUFBSUMsRUFBUkQsRUFBZUMsRUFBSUQsSUFBSUMsQ0FDdEIxQixFQUFJSSxHQUNKSixHQUFJSyxFQUFTRSxDQUNiaUIsS0FBQUEsR0FBQUEsR0FBV0csRUFBQUEsRUFBTUMsR0FBSUwsSUFDckJoQixJQUFBQSxV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dmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJteUNhbnZhc1wiKTtcbnZhciBjYW52YXNPZmZzZXQgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcbmNvbnNvbGUubG9nKFwib2Zmc2V0LWxlZnQ6IFwiLCBjYW52YXNPZmZzZXQpO1xuLy9jb25zb2xlLmxvZyhyZWN0LnRvcCwgcmVjdC5yaWdodCwgcmVjdC5ib3R0b20sIHJlY3QubGVmdCk7XG52YXIgY2FudmFzSGVpZ2h0ID0gODAwOyAvL2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibXlDYW52YXNcIikuZ2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIpO1xudmFyIGNhbnZhc1dpZHRoID0gNTAwOyAvL2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibXlDYW52YXNcIikuZ2V0QXR0cmlidXRlKFwid2lkdGhcIik7XG52YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbnZhciBpbnRlcnZhbCA9IDEwO1xuXG5cbi8vIEJsb2NrIFBhcmFtZXRlcnNcbnZhciBibG9ja0NvbG9ycyA9IFsncmVkJywgJyMwNjRkZjEnLCAnIzMzZjEwNicsICcjODAzN2RkJywgJ3llbGxvdyddO1xudmFyIGJsb2NrV2lkdGggPSA0MztcbnZhciBibG9ja0hlaWdodCA9IDI1O1xuLy8gZGljdGlvbmFyeSBvZiBibG9jayBbe2lkLCBwb3NYLCBwb3NZLCBjb2xvciwgbGV2ZWwsIGFjdGl2ZX1dXG4vL3ZhciBibG9ja3MgPSBnZW5lcmF0ZUluaXRpYWxCbG9ja3MoKTtcblxuXG4vLyBQYWRkbGUgUGFyYW10ZXJzXG52YXIgcGFkZGxlSGVpZ2h0ID0gMTU7XG52YXIgcGFkZGxlSGVpZ2h0T2Zmc2V0ID0gNDA7XG52YXIgcGFkZGxlU3BlZWQgPSAwLjU7XG52YXIgcGFkZGxlID0ge3Bvc1g6IChjYW52YXNXaWR0aCAtIDUwKS8yLCBwb3NZOiBjYW52YXNIZWlnaHQgLSBwYWRkbGVIZWlnaHRPZmZzZXQsIHZlbFg6IDAsIHZlbFk6IDAsIHdpZHRoOiAxMDAsIGhlaWdodDogMTV9O1xuXG4vL2JhbGwgcGFyYW1ldGVyczogcmFkaXVlcywgeC1wb3NpdGlvbiwgeS1wb3NpdGlvbiwgeC1hY2NlbGVyYXRpb24sIHktYWNjZWxlcmF0b2luLCB4LXZlbG9jdHksIHktdmVsb2NpdHlcbnZhciBiYWxsU3RhcnQgPSAyMDA7XG52YXIgYmFsbCA9IHtyYWRpdXM6IDEwLCBwb3NYOiA0MDAsIHBvc1k6IGJhbGxTdGFydCwgYWNjZWxYOiAwLCBhY2NlbFk6IDAsIHZlbFg6IDAsIHZlbFk6IDAuMn07XG5cbi8vIEluaXRpYWxlIFNjb3JlXG52YXIgc2NvcmUgPSAwO1xudmFyIG51bUxpdmVzID0gMTtcbnZhciBoaWdoU2NvcmUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImhpZ2hTY29yZVwiKSB8fCAwO1xudmFyIG5ld0dhbWVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5ld0dhbWVCdG5cIik7XG4vLyBSZWRyYXcgY2FudmFzIDIweC9zIC0+MS82MCA9IDAuMDVzID0gNTBtc1xuLy92YXIgZ2FtZSA9IHNldEludGVydmFsKGRyYXcsIGludGVydmFsKTtcblxuZnVuY3Rpb24gZHJhdygpIHtcblx0Ly9jbGVhciBjYW52YXMgYmVmb3JlIHJlZHJhd2luZ1xuXHRjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpO1xuXG5cdC8vZHJhdyBwYWRkbGVcblx0Y3R4LmZpbGxTdHlsZSA9ICdibGFjayc7XG5cdHBhZGRsZVBvc2l0aW9uKCk7XG5cdC8vcGFkZGxlLnBvc1ggKz0gcGFkZGxlLnZlbFgqaW50ZXJ2YWw7XG5cdC8vcGFkZGxlLnZlbFggPSAwO1xuXHRjdHguZmlsbFJlY3QocGFkZGxlLnBvc1gsIHBhZGRsZS5wb3NZLCBwYWRkbGUud2lkdGgsIHBhZGRsZS5oZWlnaHQpO1xuXG5cdFxuXHRcblx0YmFsbFBoeXNpY3MoKTtcblx0cmVmcmVzaEJsb2NrcyhibG9ja3MpO1xuXG5cdGN0eC5iZWdpblBhdGgoKTtcblx0Ly9kcmF3IGJhbGxcblxuXHQvL2NlbnRlcih4LHkpLCBzdGFydCByYWRpYW4sIGVuZCByYWRpYW5cblx0Y3R4LmFyYyhiYWxsLnBvc1gsIGJhbGwucG9zWSwgYmFsbC5yYWRpdXMsIDAgLCAyKk1hdGguUEksIGZhbHNlKTtcblx0Y3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcblx0Y3R4LmZpbGwoKTtcblx0Y3R4LnN0cm9rZSgpO1xuXG5cdC8vIFNjb3JlXG5cdHVwZGF0ZVNjb3JlKCk7XG5cblxufVxuXG4vLyBnZW5lcmF0ZSBibG9ja3Mgb24gY2FudmFzIGFuZCBwdXNoIGludG8gYmxvY2sgZGljdGlvbmFyeVxuZnVuY3Rpb24gZ2VuZXJhdGVJbml0aWFsQmxvY2tzKCkge1xuXHR2YXIgd2lkdGggPSBibG9ja1dpZHRoO1xuXHR2YXIgaGVpZ2h0ID0gYmxvY2tIZWlnaHQ7XG5cdHZhciBwb3NYID0gMDtcblx0dmFyIHBvc1kgPSAwO1xuXG5cdHZhciBpbmRleCA9IDA7XG5cdHZhciBibG9ja0FycmF5ID0gW11cblx0Zm9yKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xuXHRcdHBvc1ggPSAxMjtcblx0XHRwb3NZICs9IGhlaWdodCArIDU7XG5cdFx0Zm9yKHZhciBqID0gMDsgaiA8IDEwOyBqKyspIHtcdFxuXHRcdFx0Y3R4LmZpbGxTdHlsZSA9IGJsb2NrQ29sb3JzW2ldO1xuXHRcdFx0Y3R4LmZpbGxSZWN0KHBvc1gsIHBvc1ksIHdpZHRoLCBoZWlnaHQpO1xuXHRcdFx0YmxvY2tBcnJheS5wdXNoKHtpZDogaW5kZXgsIHBvc1g6IHBvc1gsIHBvc1k6IHBvc1ksIGNvbG9yOiBibG9ja0NvbG9yc1tpXSwgbGV2ZWw6IGksIGFjdGl2ZTogdHJ1ZX0pO1xuXHRcdFx0cG9zWCArPSB3aWR0aCArIDU7XG5cdFx0XHRpbmRleCsrO1xuXHRcdH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblx0fSAgICAgICAgICAgICBcblx0cmV0dXJuIGJsb2NrQXJyYXk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG59XG5cbi8vcmVyZW5kZXIgYmxvY2tzXG5mdW5jdGlvbiByZWZyZXNoQmxvY2tzKGJsb2NrQXJyYXkpIHtcblx0dmFyIG11bHRpSGl0cyA9IDA7XG5cdGZvcih2YXIgaSA9IDA7IGkgPCBibG9ja0FycmF5Lmxlbmd0aDsgaSsrKSB7XG5cdFx0Ly9jaGVjayBpZiBibG9jayBoaXQgYnkgYmFsbFxuXHRcdC8vaWYgYmFsbCBoaXRzIG11bHRpcGxlIGJsb2NrcyBhdCBzYW1lIHRpbWUsIHdhbnQgdG8gY2FuY2VsIHRoZSBkb3VibGUgbmVnYXRpb25cblx0XHRpZihibG9ja0hpdChibG9ja0FycmF5W2ldKSkge1xuXHRcdFx0aWYoZ2FtZUNvbXBsZXRlKCkpIGdhbWVPdmVyKCk7XG5cdFx0XHRtdWx0aUhpdHMrKztcblx0XHRcdGlmKG11bHRpSGl0cyA+IDEpIGJhbGwudmVsWSAqPSAtMTtcblx0XHR9XG5cdFx0XG5cdFx0Ly9vbmx5IHJlbmRlciBibG9ja3MgdGhhdCBoYXZlIGJlZW4gaGl0XG5cdFx0aWYoYmxvY2tBcnJheVtpXS5hY3RpdmUpIHtcblx0XHRcdGN0eC5maWxsU3R5bGUgPSBibG9ja0FycmF5W2ldLmNvbG9yO1xuXHRcdFx0Y3R4LmZpbGxSZWN0KGJsb2NrQXJyYXlbaV0ucG9zWCwgYmxvY2tBcnJheVtpXS5wb3NZLCBibG9ja1dpZHRoLCBibG9ja0hlaWdodCk7XG5cdFx0fVx0XHRcblx0fVxufVxuXG4vLyBDaGVjayBpZiBiYWxsIGhpdHMgYmxvY2sgaGVscGVyIG1ldGhvZFxuZnVuY3Rpb24gYmxvY2tIaXQocmVjdCkge1xuXHR2YXIgaGl0ID0gZmFsc2U7XG5cdHZhciBibG9ja1NlY3Rpb24gPSBibG9ja3NbYmxvY2tzLmxlbmd0aCAtMSBdLnBvc1kgKyBibG9ja0hlaWdodDtcblx0Ly9pZiBiYWxsIGlzIGluIHRoZSB0b3Agb2YgdGhlIHNjcmVlblxuXG5cdGlmKGJhbGwucG9zWSAtIGJhbGwucmFkaXVzIDw9IGJsb2NrU2VjdGlvbiAmJiByZWN0LmFjdGl2ZSkge1xuXHRcdHZhciB0b3AgPSB7eDogYmFsbC5wb3NYLCB5OiBiYWxsLnBvc1kgLSBiYWxsLnJhZGl1c307XG5cdFx0dmFyIHJpZ2h0ID0ge3g6IGJhbGwucG9zWCArIGJhbGwucmFkaXVzLCB5OiBiYWxsLnBvc1l9O1xuXHRcdHZhciBib3R0b20gPSB7eDogYmFsbC5wb3NYLCB5OiBiYWxsLnBvc1kgKyBiYWxsLnJhZGl1c307XG5cdFx0dmFyIGxlZnQgPSB7eDogYmFsbC5wb3NYIC0gYmFsbC5yYWRpdXMsIHk6IGJhbGwucG9zWX07XG5cdFx0Ly9pdGVyYXRlIG92ZXIgdGhlIGNpcmN1bWZlcmVuY2Ugb2YgdGhlIGJhbGwgYW5kIGNoZWNrIGlmIGFueSBvZiB0aGUgcG9pbnRzIGFyZSBpbnNpZGUgdGhlIHJlY3RhbmdsZVxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCAzNjA7IGkrKykgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXHRcdFx0dmFyIHggPSBiYWxsLnBvc1ggKyBiYWxsLnJhZGl1cyAqIE1hdGguY29zKGkgKiBNYXRoLlBJLzE4MCk7XG5cdFx0XHR2YXIgeSA9IGJhbGwucG9zWSAtICBiYWxsLnJhZGl1cyAqIE1hdGguc2luKGkgKiBNYXRoLlBJLzE4MCk7XG5cblx0XHRcdGlmKHggPj0gcmVjdC5wb3NYICYmIHggPD0gcmVjdC5wb3NYICsgYmxvY2tXaWR0aCkge1xuXHRcdFx0XHRpZih5IDw9IHJlY3QucG9zWSArIGJsb2NrSGVpZ2h0ICYmIHkgPj0gcmVjdC5wb3NZKSB7XG5cdFx0XHRcdFx0aGl0ID0gdHJ1ZTtcblx0XHRcdFx0XHRiYWxsLnZlbFkgKj0gLTE7XG5cdFx0XHRcdFx0c2NvcmUgKz0gKDQwIC0gMTAqcmVjdC5sZXZlbCArIDEpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVx0XHRcblx0fVxuXHRpZihoaXQpIHtcblx0XHRibG9ja3NbcmVjdC5pZF0uYWN0aXZlID0gZmFsc2U7XG5cdFx0cmV0dXJuIHRydWVcblx0fSBcblx0cmV0dXJuIGZhbHNlO1x0XG59XG5cblxuXG4vLyBFdmVudCBIYW5kbGVycyBmb3IgcGFkZGxlIGNvbnRyb2xcbmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdHZhciB4ID0gZXZlbnQuY2xpZW50WCAtIGNhbnZhc09mZnNldDtcblx0dmFyIHkgPSBldmVudC5jbGllbnRZO1xuXHRwYWRkbGUucG9zWCA9IHg7XG5cdC8vY29uc29sZS5sb2coJ206ICcsIHgpO1xufSk7XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbihldmVudCkge1xuXHQvLyBtb3ZlIHBhZGRsZSBwb3MgbGVmdCBpZiBsZWZ0IGJ1dHRvbiBwcmVzc2VkXG5cdGlmKGV2ZW50LmtleUNvZGUgPT0gMzcpIHtcblx0XHRwYWRkbGUudmVsWCA9IC1wYWRkbGVTcGVlZDtcblx0XHQvLyBjb25zb2xlLmxvZygndCcpO1xuXHR9XG5cdC8vbW92ZSBwYWRkbGUgcG9zIHJpZ2h0IGlmIHJpZ2h0IGJ1dHRvbiBwcmVzc2VkXG5cdGVsc2UgaWYoZXZlbnQua2V5Q29kZSA9PSAzOSkge1xuXHRcdHBhZGRsZS52ZWxYID0gcGFkZGxlU3BlZWQ7XG5cdH1cbn0pO1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdC8vIG1vdmUgcGFkZGxlIHBvcyBsZWZ0IGlmIGxlZnQgYnV0dG9uIHByZXNzZWRcblx0aWYoZXZlbnQua2V5Q29kZSA9PSAzNyB8fCBldmVudC5rZXlDb2RlID09IDM5KSB7XG5cdFx0cGFkZGxlLnZlbFggPSAwO1xuXHR9XG5cdFxufSk7XG5mdW5jdGlvbiBwYWRkbGVQb3NpdGlvbigpIHtcblx0cGFkZGxlLnBvc1ggKz0gcGFkZGxlLnZlbFggKiBpbnRlcnZhbDtcblx0cGFkZGxlLnBvc1ggPSBwYWRkbGUucG9zWCA+PSBjYW52YXNXaWR0aCAtIHBhZGRsZS53aWR0aCA/IGNhbnZhc1dpZHRoIC0gcGFkZGxlLndpZHRoIDogcGFkZGxlLnBvc1g7XG5cdHBhZGRsZS5wb3NYID0gcGFkZGxlLnBvc1ggPD0gMCA/IDAgOiBwYWRkbGUucG9zWDtcbn1cblxuXG5cbmZ1bmN0aW9uIGJhbGxQaHlzaWNzKCkge1xuXG5cdC8vIFVwZGF0ZSBCYWxsIHBvc2l0aW9uXG5cdGJhbGwucG9zWSArPSBiYWxsLnZlbFkgKiBpbnRlcnZhbDtcblx0YmFsbC5wb3NYICs9IGJhbGwudmVsWCAqIGludGVydmFsO1xuXHRcblx0Ly9pZiBiYWxsIGhpdHMgYm90dG9tIHdhbGxcblx0aWYoYmFsbC5wb3NZICsgYmFsbC5yYWRpdXMgPj0gY2FudmFzSGVpZ2h0KSB7XG5cdFx0Y29uc29sZS5sb2coJ2JvdHRvbSB3YWxsIGhpdCcpO1xuXHRcdGxpZmVMb3N0KCk7XG5cdFx0Ly9iYWxsLnZlbFkgKj0gLTE7XG5cdH1cblxuXHQvL2lmIGJhbGwgaGlzdCB0b3Agd2FsbFxuXHRpZihiYWxsLnBvc1kgLSBiYWxsLnJhZGl1cyA8PSAwKSB7XG5cdFx0Y29uc29sZS5sb2coJ3RvcCB3YWxsIGhpdCcpO1xuXHRcdGJhbGwudmVsWSAqPSAtMTtcblx0fVxuXG5cdC8vaWYgdmFsbCBoaXRzIHJpZ2h0IHdhbGxcblx0aWYoYmFsbC5wb3NYICsgYmFsbC5yYWRpdXMgPj0gY2FudmFzV2lkdGgpIHtcblx0XHRjb25zb2xlLmxvZygncmlnaHQgd2FsbCBoaXQnKTtcblx0XHRiYWxsLnZlbFggKj0gLTE7XG5cdH1cblxuXHQvL2lmIGJhbGwgaGl0cyBsZWZ0IHdhbGxcblx0aWYoYmFsbC5wb3NYIC0gYmFsbC5yYWRpdXMgPD0gMCkge1xuXHRcdGNvbnNvbGUubG9nKCdsZWZ0IHdhbGwgaGl0Jyk7XG5cdFx0YmFsbC52ZWxYICo9IC0xO1xuXHR9XG5cblxuXHQvL2JhbGwgYXQgcGFkZGxlIGxldmVsXG5cdGlmKGJhbGwucG9zWSA+PSBjYW52YXNIZWlnaHQgLSBwYWRkbGVIZWlnaHQgLSBwYWRkbGVIZWlnaHRPZmZzZXQpIHtcblx0XHQvL2JhbGwgaGl0cyBwYWRkbGVcblx0XHRpZigoYmFsbC5wb3NYIC0gYmFsbC5yYWRpdXMgPD0gcGFkZGxlLnBvc1ggKyBwYWRkbGUud2lkdGgpICYmIChiYWxsLnBvc1ggKyBiYWxsLnJhZGl1cyA+PSBwYWRkbGUucG9zWCkpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwicGFkZGxlIGhpdFwiKTtcblx0XHRcdGJhbGwudmVsWSAqPSAtMTtcblx0XHRcdHZhciBzcGVlZCA9IGJhbGwucG9zWC8ocGFkZGxlLnBvc1ggKyAwLjUqcGFkZGxlLndpZHRoKSAtIDE7XG5cdFx0XHRiYWxsLnZlbFggPSBzcGVlZCA+IDAuNSA/IDAuNSA6IHNwZWVkOzEwXG5cdFx0fVxuXHR9XG59XG5mdW5jdGlvbiB1cGRhdGVTY29yZSgpIHtcblx0dmFyIHNjb3JlTWVzc2FnZSA9IFwiU2NvcmU6IFwiICsgc2NvcmUgXG5cdHZhciBsaXZlTWVzc2FnZSA9IFwiTGl2ZXM6IFwiICsgbnVtTGl2ZXM7XG5cdGN0eC5mb250ID0gXCIzMHB4IHNhbnMtc2VyaWZcIjtcblx0Y3R4LmZpbGxUZXh0KHNjb3JlTWVzc2FnZSwgMTAsIDUwKTtcblx0Y3R4LmZpbGxUZXh0KGxpdmVNZXNzYWdlLCAzNTAsIDUwKTtcblx0XG59XG5mdW5jdGlvbiBsaWZlTG9zdCgpIHtcblx0bnVtTGl2ZXMtLTtcblx0aWYobnVtTGl2ZXMgPT0gMCkge1xuXHRcdGdhbWVPdmVyKCk7XG5cdH1cblx0YmFsbC5wb3NZID0gYmFsbFN0YXJ0O1xufVxuXG5mdW5jdGlvbiBnYW1lQ29tcGxldGUoKSB7XG5cdGZvcih2YXIgaSA9IDA7IGkgPCBibG9ja3MubGVuZ3RoOyBpKyspIHtcblx0XHRpZihibG9ja3NbaV0uYWN0aXZlKSByZXR1cm4gZmFsc2U7XG5cdH1cblx0cmV0dXJuIHRydWU7XG59XG5mdW5jdGlvbiBnYW1lT3ZlcigpIHtcblx0Y29uc29sZS5sb2coXCJHYW1lIE92ZXJcIik7XG5cdGNsZWFySW50ZXJ2YWwoZ2FtZSk7XG5cdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0Ly8gQ2xlYXIgQ2FudmFzXG5cdFx0Y3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXNXaWR0aCwgY2FudmFzSGVpZ2h0KTtcblxuXHRcdFxuXG5cdFx0dmFyIGN1cnJIaWdoU2NvcmUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImhpZ2hTY29yZVwiKTtcblx0XHRzY29yZSA+ICBjdXJySGlnaFNjb3JlID8gaGlnaFNjb3JlID0gc2NvcmUgOiBoaWdoU2NvcmU7XG5cdFx0bG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJoaWdoU2NvcmVcIiwgaGlnaFNjb3JlKTtcblx0XHRuZXdHYW1lQnRuLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZVwiO1xuXHRcdFxuXHRcdHZhciBtZXNzYWdlMSA9IFwiR0FNRSBPVkVSXCI7XG5cdFx0dmFyIG1lc3NhZ2UyID0gXCJZb3VyIFNjb3JlOiBcIiArIHNjb3JlOyBcblx0XHR2YXIgbWVzc2FnZTMgPSBcIllvdXIgSGlnaCBzY29yZTogXCIgKyBoaWdoU2NvcmU7XG5cdFx0XG5cdFx0Y3R4LmZvbnQgPSBcIjMwcHggc2Fucy1zZXJpZlwiO1xuXHRcdGN0eC5maWxsVGV4dChtZXNzYWdlMSwgMTUwLCA1MCk7XG5cdFx0Y3R4LmZpbGxUZXh0KG1lc3NhZ2UyLCAxNTAsIDE1MCk7XG5cdFx0Y3R4LmZpbGxUZXh0KG1lc3NhZ2UzLCAxNTAsIDIwMCk7XG5cdH0sIGludGVydmFsKTtcblx0XG59XG5uZXdHYW1lQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCkge1xuXHRuZXdHYW1lQnRuLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0YmxvY2tzID0gZ2VuZXJhdGVJbml0aWFsQmxvY2tzKCk7XG5cdG51bUxpdmVzID0gMTtcblx0c2NvcmUgPSAwO1xuXHRnYW1lID0gc2V0SW50ZXJ2YWwoZHJhdywgaW50ZXJ2YWwpO1xufSk7XG4iLCJjb25zb2xlLmxvZygnd29ya2luZycpO1xuXG5cbmNsYXNzIEdhbWUge1xuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHQvLyBHYW1lIFNjcmVlblxuXHRcdHRoaXMuY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJteUNhbnZhc1wiKTtcblx0XHR0aGlzLmN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXHRcdHRoaXMuY2FudmFzT2Zmc2V0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XHRcblx0XHR0aGlzLmNhbnZhc1dpZHRoID0gNTAwO1xuXHRcdHRoaXMuY2FudmFzSGVpZ2h0ID0gODAwO1xuXG5cdFx0Ly8gR2FtZSBTZXR0aW5nc1xuXHRcdHRoaXMuaW50ZXJ2YWwgPSAxMDtcblx0XHR0aGlzLnNjb3JlID0gMDtcblx0XHR0aGlzLmhpZ2hTY29yZSA9IDA7XG5cdFx0dGhpcy5udW1MaXZlcyA9IDM7XG5cdFx0XG5cdFx0Ly8gQmxvY2tzIGluaXRpYWxpemVkXG5cdFx0dGhpcy5ibG9ja1dpZHRoID0gNDM7XG5cdFx0dGhpcy5ibG9ja0hlaWdodCA9IDI1O1xuXHRcdHRoaXMuYmxvY2tzID0gIG5ldyBCbG9ja3MoKTtcblxuXHRcdC8vIFBhZGRsZSBpbml0aWFsaXplZCBpbiB0aGUgYm90dG9tIG1pZGRsZSBvZiBzY3JlZW5cblx0XHR0aGlzLnBhZGRsZSA9IG5ldyBQYWRkbGUoKHRoaXMuY2FudmFzV2lkdGggLSAxMDApLzIsIHRoaXMuY2FudmFzSGVpZ2h0IC0gNDAsIHRoaXMuY2FudmFzKTtcblxuXHRcdC8vIEJhbGwgaW5pdGlhbGl6ZWRcblx0XHR0aGlzLmJhbGwgPSBuZXcgQmFsbCgodGhpcy5jYW52YXNXaWR0aCkvMiwgNDAwKTtcblx0fVxuXG5cblx0ZHJhd0Jsb2NrcygpIHtcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5ibG9ja3MuYmxvY2tBcnIubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBibG9jayA9IHRoaXMuYmxvY2tzLmJsb2NrQXJyW2ldO1xuXHRcdFx0aWYoYmxvY2suYWN0aXZlKSB7XG5cdFx0XHRcdHRoaXMuY3R4LmZpbGxTdHlsZSA9IGJsb2NrLmNvbG91cjtcblx0XHRcdFx0dGhpcy5jdHguZmlsbFJlY3QoYmxvY2sucG9zWCwgYmxvY2sucG9zWSwgYmxvY2sud2lkdGgsIGJsb2NrLmhlaWdodCk7XG5cdFx0XHR9XHRcblx0XHR9ICAgICBcblx0fVxuXG5cdGRyYXdQYWRkbGUoKSB7XG5cdFx0dGhpcy5jdHguZmlsbFN0eWxlID0gdGhpcy5wYWRkbGUuY29sb3VyO1xuXHRcdHRoaXMuY3R4LmZpbGxSZWN0KHRoaXMucGFkZGxlLnBvc1gsIHRoaXMucGFkZGxlLnBvc1ksIHRoaXMucGFkZGxlLndpZHRoLCB0aGlzLnBhZGRsZS5oZWlnaHQpO1xuXG5cdH1cblxuXHRkcmF3QmFsbCgpIHtcblx0XHRjdHguYmVnaW5QYXRoKCk7XG5cdFx0Ly9jZW50ZXIoeCx5KSwgc3RhcnQgcmFkaWFuLCBlbmQgcmFkaWFuXG5cdFx0Y3R4LmFyYyh0aGlzLmJhbGwucG9zWCwgdGhpcy5iYWxsLnBvc1ksIHRoaXMuYmFsbC5yYWRpdXMsIDAgLCAyKk1hdGguUEksIGZhbHNlKTtcblx0XHRjdHguZmlsbFN0eWxlID0gdGhpcy5iYWxsLmNvbG91cjtcblx0XHRjdHguZmlsbCgpO1xuXHRcdGN0eC5zdHJva2UoKTtcblx0fVxuXG5cdGRyYXdTY3JlZW4oKSB7XG5cdFx0Ly9jbGVhciBjYW52YXMgYmVmb3JlIHJlZHJhd2luZ1xuXHRcdGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzV2lkdGgsIGNhbnZhc0hlaWdodCk7XG5cblx0XHR0aGlzLnBhZGRsZS51cGRhdGVQb3NpdGlvbigpO1xuXHRcdHRoaXMuYmFsbC5iYWxsUGh5c2ljcyh0aGlzLmludGVydmFsLCB0aGlzLmNhbnZhc1dpZHRoLCB0aGlzLmNhbnZhc0hlaWdodCwgdGhpcy5wYWRkbGUsIHRoaXMuYmxvY2tzKTtcblx0XHR0aGlzLmJsb2Nrcy51cGRhdGVCbG9ja3ModGhpcy5iYWxsKTtcblx0XHR0aGlzLmRyYXdCbG9ja3MoKTtcblx0XHR0aGlzLmRyYXdQYWRkbGUoKTtcblx0XHR0aGlzLmRyYXdCYWxsKCk7XG5cdFx0XG5cdH1cblx0c3RhcnRHYW1lKCkge1xuXHRcdHZhciB0ID0gdGhpcztcblx0XHRzZXRJbnRlcnZhbChmdW5jdGlvbigpIHt0LmRyYXdTY3JlZW4oKX0sIHQuaW50ZXJ2YWwpO1xuXHR9XG59XG5cbmNsYXNzIEJhbGwge1xuXHRjb25zdHJ1Y3Rvcihwb3NYLCBwb3NZKSB7XG5cdFx0dGhpcy5jb2xvdXIgPSAnd2hpdGUnO1xuXHRcdHRoaXMucmFkaXVzID0gMTA7XG5cdFx0dGhpcy5wb3NYID0gcG9zWDtcblx0XHR0aGlzLnBvc1kgPSBwb3NZO1xuXHRcdHRoaXMudmVsWCA9IDA7XG5cdFx0dGhpcy52ZWxZID0gMC4yO1xuXHR9XG5cdC8qIFVwZGF0ZSBiYWxsIHBvc2l0aW9uIG9uIGNhbnZhcyovXG5cdGJhbGxQaHlzaWNzKGludGVydmFsLCBjYW52YXNXaWR0aCwgY2FudmFzSGVpZ2h0LCBwYWRkbGUsIGJsb2Nrcykge1xuXHRcdC8vIFVwZGF0ZSBCYWxsIHBvc2l0aW9uXG5cdFx0dGhpcy5wb3NZICs9IHRoaXMudmVsWSAqIGludGVydmFsO1xuXHRcdHRoaXMucG9zWCArPSB0aGlzLnZlbFggKiBpbnRlcnZhbDtcblx0XG5cdFx0Ly9pZiBiYWxsIGhpdHMgYm90dG9tIHdhbGxcblx0XHRpZih0aGlzLnBvc1kgKyB0aGlzLnJhZGl1cyA+PSBjYW52YXNIZWlnaHQpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdib3R0b20gd2FsbCBoaXQnKTtcblx0XHRcdGxpZmVMb3N0KCk7XG5cdFx0XHR0aGlzLnZlbFkgKj0gLTE7XG5cdFx0fVxuXG5cdFx0Ly9pZiBiYWxsIGhpc3QgdG9wIHdhbGxcblx0XHRpZih0aGlzLnBvc1kgLSB0aGlzLnJhZGl1cyA8PSAwKSB7XG5cdFx0XHRjb25zb2xlLmxvZygndG9wIHdhbGwgaGl0IC1hJyk7XG5cdFx0XHR0aGlzLnZlbFkgKj0gLTE7XG5cdFx0fVxuXG5cdFx0Ly9pZiB2YWxsIGhpdHMgcmlnaHQgd2FsbFxuXHRcdGlmKHRoaXMucG9zWCArIHRoaXMucmFkaXVzID49IGNhbnZhc1dpZHRoKSB7XG5cdFx0XHRjb25zb2xlLmxvZygncmlnaHQgd2FsbCBoaXQgLWEnKTtcblx0XHRcdHRoaXMudmVsWCAqPSAtMTtcblx0XHR9XG5cblx0XHQvL2lmIGJhbGwgaGl0cyBsZWZ0IHdhbGxcblx0XHRpZih0aGlzLnBvc1ggLSB0aGlzLnJhZGl1cyA8PSAwKSB7XG5cdFx0XHRjb25zb2xlLmxvZygnbGVmdCB3YWxsIGhpdCAtYScpO1xuXHRcdFx0dGhpcy52ZWxYICo9IC0xO1xuXHRcdH1cblxuXG5cdFx0Ly9iYWxsIGF0IHBhZGRsZSBsZXZlbFxuXHRcdGlmKHRoaXMucG9zWSA+PSBjYW52YXNIZWlnaHQgLSBwYWRkbGUuaGVpZ2h0IC0gcGFkZGxlLmhlaWdodE9mZnNldCkge1xuXHRcdFx0Ly9iYWxsIGhpdHMgcGFkZGxlXG5cdFx0XHRpZigodGhpcy5wb3NYIC0gdGhpcy5yYWRpdXMgPD0gcGFkZGxlLnBvc1ggKyBwYWRkbGUud2lkdGgpICYmICh0aGlzLnBvc1ggKyB0aGlzLnJhZGl1cyA+PSBwYWRkbGUucG9zWCkpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJwYWRkbGUgaGl0IC1hXCIpO1xuXHRcdFx0XHR0aGlzLnZlbFkgKj0gLTE7XG5cdFx0XHRcdHZhciBzcGVlZCA9IHRoaXMucG9zWC8ocGFkZGxlLnBvc1ggKyAwLjUqcGFkZGxlLndpZHRoKSAtIDE7XG5cdFx0XHRcdHRoaXMudmVsWCA9IHNwZWVkID4gMC41ID8gMC41IDogc3BlZWQ7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdGdldChwcm9wZXJ0eSkge1xuXHRcdHJldHVybiB0aGlzW3Byb3BlcnR5XTtcblx0fVxuXHQvKiBDaGVjayBpZiBiYWxsIGhhcyBoaXQgdGhlIHBhZGRsZSAqL1xuXHQvKiBDaGVjayBpZiBiYWxsIGhhcyBoaXQgYSB3YWxsICovXG5cdC8qIENoZWNrIGlmIGJhbGwgaGFzIGhpdCBhIGJsb2NrICovXG5cbn1cbiBcbmNsYXNzIFBhZGRsZSB7XG5cdGNvbnN0cnVjdG9yKHBvc1gsIHBvc1ksIGNhbnZhcykge1xuXHRcdHRoaXMuY29sb3VyID0gJ2JsYWNrJztcblx0XHR0aGlzLndpZHRoID0gMTAwO1xuXHRcdHRoaXMuaGVpZ2h0ID0gMTU7XG5cdFx0dGhpcy5oZWlnaHRPZmZzZXQgPSA0MDtcblx0XHR0aGlzLnBvc1ggPSBwb3NYO1xuXHRcdHRoaXMucG9zWSA9IHBvc1k7XG5cdFx0dGhpcy52ZWxYID0gMDtcblx0XHR0aGlzLnNwZWVkID0gMC41O1xuXHRcdHRoaXMuY2FudmFzID0gY2FudmFzO1xuXHRcdHRoaXMuY2FudmFzT2Zmc2V0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XHRcblx0XHR2YXIgdCA9IHRoaXM7XG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdFxuXHRcdFx0Ly8gbW92ZSBwYWRkbGUgcG9zIGxlZnQgaWYgbGVmdCBidXR0b24gcHJlc3NlZFxuXHRcdFx0aWYoZXZlbnQua2V5Q29kZSA9PSAzNykge1xuXHRcdFx0XHR0LnZlbFggPSAtdC5zcGVlZDtcblx0XHRcdH1cblx0XHRcdC8vbW92ZSBwYWRkbGUgcG9zIHJpZ2h0IGlmIHJpZ2h0IGJ1dHRvbiBwcmVzc2VkXG5cdFx0XHRlbHNlIGlmKGV2ZW50LmtleUNvZGUgPT0gMzkpIHtcblx0XHRcdFx0dC52ZWxYID0gdC5zcGVlZDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0Ly8gbW92ZSBwYWRkbGUgcG9zIGxlZnQgaWYgbGVmdCBidXR0b24gcHJlc3NlZFxuXHRcdFx0aWYoZXZlbnQua2V5Q29kZSA9PSAzNyB8fCBldmVudC5rZXlDb2RlID09IDM5KSB7XG5cdFx0XHRcdHQudmVsWCA9IDA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9KTtcblxuXHRcdC8vIEV2ZW50IEhhbmRsZXJzIGZvciBwYWRkbGUgY29udHJvbFxuXHRcdHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdHZhciB4ID0gZXZlbnQuY2xpZW50WCAtIHQuY2FudmFzT2Zmc2V0O1xuXHRcdFx0dC5wb3NYID0geDtcblx0XHR9KTtcblx0XHRcblx0fVxuXHRcblx0LyogVXBkYXRlIHBhZGRsZSBwb3NpdGlvbiAqL1xuXHR1cGRhdGVQb3NpdGlvbigpIHtcblx0XHQvLyBjb25zb2xlLmxvZyh0aGlzLnZlbFgpO1xuXHRcdHRoaXMucG9zWCArPSB0aGlzLnZlbFggKiBpbnRlcnZhbDtcblx0XHR0aGlzLnBvc1ggPSB0aGlzLnBvc1ggPj0gY2FudmFzV2lkdGggLSB0aGlzLndpZHRoID8gY2FudmFzV2lkdGggLSB0aGlzLndpZHRoIDogdGhpcy5wb3NYO1xuXHRcdHRoaXMucG9zWCA9IHRoaXMucG9zWCA8PSAwID8gMCA6IHRoaXMucG9zWDtcblx0fVxuXG5cdGdldChwcm9wZXJ0eSkge1xuXHRcdHJldHVybiB0aGlzW3Byb3BlcnR5XTtcblx0fVxuXHRcblx0XG5cdFxufVxuXG5jbGFzcyBCbG9jayB7XG5cdGNvbnN0cnVjdG9yKGlkLCBsZXZlbCwgYWN0aXZlLCBjb2xvdXIsIHBvc1gsIHBvc1ksIHdpZHRoLCBoZWlnaHQpIHtcblx0XHR0aGlzLmlkID0gaWQ7XG5cdFx0dGhpcy5sZXZlbCA9IGxldmVsO1xuXHRcdHRoaXMuYWN0aXZlID0gYWN0aXZlO1xuXHRcdHRoaXMuY29sb3VyID0gY29sb3VyO1xuXHRcdHRoaXMucG9zWCA9IHBvc1g7XG5cdFx0dGhpcy5wb3NZID0gcG9zWTtcblx0XHR0aGlzLndpZHRoID0gd2lkdGg7XG5cdFx0dGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cdH1cblx0Z2V0IChwcm9wZXJ0eSkge1xuXHRcdHJldHVybiB0aGlzW3Byb3BlcnR5XTtcblx0fVxuXG5cdGJsb2NrSGl0KGJhbGwpIHtcblx0XHR2YXIgaGl0ID0gZmFsc2U7XG5cdFx0dmFyIGJsb2NrU2VjdGlvbiA9IHRoaXMucG9zWSArIHRoaXMuaGVpZ2h0O1xuXHRcdFxuXHRcdGlmKGJhbGwucG9zWSAtIGJhbGwucmFkaXVzIDw9IGJsb2NrU2VjdGlvbiAmJiB0aGlzLmFjdGl2ZSkge1xuXHRcdFx0Ly9pdGVyYXRlIG92ZXIgdGhlIGNpcmN1bWZlcmVuY2Ugb2YgdGhlIGJhbGwgYW5kIGNoZWNrIGlmIGFueSBvZiB0aGUgcG9pbnRzIGFyZSBpbnNpZGUgdGhlIHJlY3RhbmdsZVxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IDM2MDsgaSsrKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdFx0XHRcdHZhciB4ID0gYmFsbC5wb3NYICsgYmFsbC5yYWRpdXMgKiBNYXRoLmNvcyhpICogTWF0aC5QSS8xODApO1xuXHRcdFx0XHR2YXIgeSA9IGJhbGwucG9zWSAtICBiYWxsLnJhZGl1cyAqIE1hdGguc2luKGkgKiBNYXRoLlBJLzE4MCk7XG5cblx0XHRcdFx0aWYoeCA+PSB0aGlzLnBvc1ggJiYgeCA8PSB0aGlzLnBvc1ggKyB0aGlzLndpZHRoKSB7XG5cdFx0XHRcdFx0aWYoeSA8PSB0aGlzLnBvc1kgKyB0aGlzLmhlaWdodCAmJiB5ID49IHRoaXMucG9zWSkge1xuXHRcdFx0XHRcdFx0aGl0ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdGJhbGwudmVsWSAqPSAtMTtcblx0XHRcdFx0XHRcdHNjb3JlICs9ICg0MCAtIDEwKnRoaXMubGV2ZWwgKyAxKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVx0XHRcblx0XHR9XG5cdFx0aWYoaGl0KSB7XG5cdFx0XHR0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSBcblx0XHRyZXR1cm4gZmFsc2U7XHRcblx0fVxufVxuXG5jbGFzcyBCbG9ja3Mge1xuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHR0aGlzLmJsb2NrQXJyID0gdGhpcy5nZW5lcmF0ZUJsb2NrcygpO1xuXHR9XG5cblx0LyogR2VuZXJhdGUgdGhlIGludGlhbCBibG9ja3MgKi9cblx0Z2VuZXJhdGVCbG9ja3MoKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJibG9ja3MgZ2VuZXJhdGVkXCIpO1xuXHRcdHZhciB3aWR0aCA9IDQzO1xuXHRcdHZhciBoZWlnaHQgPSAyNTtcblx0XHR2YXIgcG9zWCA9IDA7XG5cdFx0dmFyIHBvc1kgPSAwO1xuXHRcdHZhciBibG9ja0NvbG91cnMgPSBbJ3JlZCcsICcjMDY0ZGYxJywgJyMzM2YxMDYnLCAnIzgwMzdkZCcsICd5ZWxsb3cnXTtcblx0XHR2YXIgaW5kZXggPSAwO1xuXHRcdHZhciBibG9ja0FycmF5ID0gW11cblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG5cdFx0XHRwb3NYID0gMTI7XG5cdFx0XHRwb3NZICs9IGhlaWdodCArIDU7XG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgMTA7IGorKykge1x0XG5cdFx0XHRcdHZhciBibG9jayA9IG5ldyBCbG9jayhpbmRleCwgaSwgdHJ1ZSwgYmxvY2tDb2xvdXJzW2ldLCBwb3NYLCBwb3NZLCB3aWR0aCwgaGVpZ2h0KTtcblx0XHRcdFx0YmxvY2tBcnJheS5wdXNoKGJsb2NrKTtcblx0XHRcdFx0cG9zWCArPSB3aWR0aCArIDU7XG5cdFx0XHRcdGluZGV4Kys7XG5cdFx0XHR9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdFx0fVxuXHRcdCAgICAgICAgICBcblx0XHQvLyBjb25zb2xlLmxvZyhibG9ja0FycmF5KTtcblx0XHRyZXR1cm4gYmxvY2tBcnJheTsgICAgICAgICAgICAgIFxuXHR9XG5cdHVwZGF0ZUJsb2NrcyhiYWxsKSB7XG5cdFx0dmFyIG11bHRpSGl0cyA9IDA7XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuYmxvY2tBcnIubGVuZ3RoOyBpKyspIHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKHRoaXMuYmxvY2tzQXJyW2ldKTtcblx0XHRcdGlmKHRoaXMuYmxvY2tBcnJbaV0uYmxvY2tIaXQoYmFsbCkpIHtcblx0XHRcdFx0bXVsdGlIaXRzKys7XG5cdFx0XHRcdGlmKG11bHRpSGl0cyA+IDEpIGJhbGwudmVsWSAqPSAtMTtcblx0XHRcdH1cblx0XHR9XG5cdH0gICBcblxuXG5cdGdldCAocHJvcGVydHkpIHtcblx0XHRjb25zb2xlLmxvZyhwcm9wZXJ0eSlcblx0XHRyZXR1cm4gdGhpc1twcm9wZXJ0eV07XG5cdH1cbn1cblxuLy8gRG8gc2hpdCBoZXJlXG5cbnZhciBnYW1lID0gbmV3IEdhbWUoKTtcbmdhbWUuc3RhcnRHYW1lKCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
